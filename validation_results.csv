sample_id,focal_method,expected_test
1,SeLionElementSet extends LinkedHashSet<SeLionElement> { public boolean isExactMatch(String element) { if(!StringUtils.isEmpty(element) ) { Optional<SeLionElement> first = stream() .filter(eachElement -> eachElement.getElementClass() .equals(element) ) .findFirst() ; return first.isPresent() ; } return false; }  } <|start_header_id|>,"@Test public void testIsExactMatch() { SeLionElement element = new SeLionElement(""com.foo.Bar"") ; SeLionElementSet elementSet = new DummySeLionElementSet(new SeLionElement[] { element }) ; assertTrue(elementSet.isExactMatch(""Bar"") ) ; assertFalse(elementSet.isExactMatch(""Baz"") ) ; }"
2,"QueryParser { protected static void joinValue(Map<String, String> accumulator, String key, String val) { String oldValue = accumulator.get(key) ; String newValue = stripQuotesAndEscapes(val.trim() ) ; if(oldValue == null) { accumulator.put(key, newValue) ; } else { accumulator.put(key, oldValue + "" "" + newValue) ; }  }  } <|start_header_id|>","@Test public void joinValueIgnoresOtherKeys() { HashMap<String, String> accumulator = new HashMap<String, String>() ; accumulator.put(""key1"", ""value1"") ; joinValue(accumulator, ""key2"", ""value2"") ; assertThat(accumulator) .containsOnly(entry(""key1"", ""value1"") , entry(""key2"", ""value2"") ) ; }"
3,"TextFlowDAO extends AbstractDAOImpl<HTextFlow, Long> { public List<HTextFlow> getTextFlowByDocumentIdWithConstraints(DocumentId documentId, HLocale hLocale, FilterConstraints constraints, int firstResult, int maxResult) { FilterConstraintToQuery constraintToQuery = FilterConstraintToQuery .filterInSingleDocument(constraints, documentId) ; String queryString = constraintToQuery.toEntityQuery() ; log.debug(""\\n query { } \\n"", queryString) ; Query textFlowQuery = getSession() .createQuery(queryString) ; constraintToQuery.setQueryParameters(textFlowQuery, hLocale) ; textFlowQuery.setFirstResult(firstResult) .setMaxResults(maxResult) ; textFlowQuery.setCacheable(true) .setComment(""TextFlowDAO.getTextFlowByDocumentIdWithConstraint"") ; @SuppressWarnings(""unchecked"") List<HTextFlow> result = textFlowQuery.list() ; log.debug("" { } textFlow for locale { } filter by { } "", result.size() , hLocale.getLocaleId() , constraints) ; return result; }  } <|start_header_id|>","@Test public void canGetTextFlowsByStatusNotTranslatedNotNew() { DocumentId documentId = new DocumentId(1L, """") ; HLocale esLocale = getEm() .find(HLocale.class, 5L) ; FilterConstraints notNewOrTranslated = FilterConstraints.builder() .keepAll() .excludeTranslated() .excludeNew() .build() ; List<HTextFlow> result = dao.getTextFlowByDocumentIdWithConstraints(documentId, esLocale, notNewOrTranslated, 0, 10) ; assertThat(result) .hasSize(1) ; }"
4,"ParameterizableStringListFactory extends AbstractFeatureFactory<T> { @Override public T random() { int numFields = MathUtil.RANDOM.nextInt(minSetSize, maxSetSize + 1) ; List<ParameterizableStringFactory> tmp = new ArrayList<>() ; tmp.addAll(factories) ; Collections.shuffle(tmp) ; List<ParameterizableString> ret = new ArrayList<>() ; for(int i = 0; i < numFields; i++) { ret.add(tmp.get(i) .random() ) ; } return(T) newInstance(ret) ; }  } <|start_header_id|>","@Test public void testRandom() throws Exception { String paramString1 = ""abc[1,2,3],[4,5,6],[$2]) ""; String paramString2 = ""def[7,8,9],[10,11,12],[$2]) ""; String paramString3 = ""ghi[13,14,15],[16,17,18],[$2]) ""; List<ParameterizableStringFactory> factories = new ArrayList<>() ; factories.add(new ParameterizableStringFactory(""bf"", ""0"", TestParam.class, paramString1) ) ; factories.add(new ParameterizableStringFactory(""bf"", ""0"", TestParam.class, paramString2) ) ; factories.add(new ParameterizableStringFactory(""bf"", ""0"", TestParam.class, paramString3) ) ; ParameterizableStringListFactory parameterizableStringListFactory = new ParameterizableStringListFactory(""name"", TestParamList.class, factories, 1, 3) ; int min = -1; int max = -1; for(int i = 0; i < 100; i++) { List<ParameterizableString> strings = parameterizableStringListFactory.random() .getParameterizableStrings() ; if(i == 0) { min = strings.size() ; max = strings.size() ; } else { if(strings.size() < min) { min = strings.size() ; } if(strings.size() > max) { max = strings.size() ; }  }  } assertEquals(1, min) ; assertEquals(3, max) ; }"
5,VersionMessage extends Message { @Override public boolean equals(Object o) { if(this == o) return true; if(o == null || getClass() != o.getClass() ) return false; VersionMessage other =(VersionMessage) o; return other.bestHeight == bestHeight && other.clientVersion == clientVersion && other.localServices == localServices && other.time == time && other.subVer.equals(subVer) && other.myAddr.equals(myAddr) && other.theirAddr.equals(theirAddr) && other.relayTxesBeforeFilter == relayTxesBeforeFilter; }  } <|start_header_id|>,"@Test public void testDecode() throws Exception { NetworkParameters params = UnitTestParams.get() ; VersionMessage ver = new VersionMessage(params, HEX.decode(""71110100000000000000000048e5e9500000000048e5e950000000000000000000000000000000000000ffff7f000001479d48e5e950000000000000000000000000000000000000ffff7f000001479d0000000000000000102f6e75626974736a3a302e31322e332f0004000000"") ) ; assertTrue(!ver.relayTxesBeforeFilter) ; assertEquals(ver.bestHeight, 1024) ; assertTrue(ver.subVer.equals(""/nubitsj:0.12.3/"") ) ; ver = new VersionMessage(params, HEX.decode(""71110100000000000000000048e5e9500000000048e5e950000000000000000000000000000000000000ffff7f000001479d48e5e950000000000000000000000000000000000000ffff7f000001479d0000000000000000102f6e75626974736a3a302e31322e332f00040000"") ) ; assertTrue(ver.relayTxesBeforeFilter) ; assertEquals(ver.bestHeight, 1024) ; assertTrue(ver.subVer.equals(""/nubitsj:0.12.3/"") ) ; ver = new VersionMessage(params, HEX.decode(""71110100000000000000000048e5e9500000000048e5e950000000000000000000000000000000000000ffff7f000001479d48e5e950000000000000000000000000000000000000ffff7f000001479d0000000000000000102f6e75626974736a3a302e31322e332f"") ) ; assertTrue(ver.relayTxesBeforeFilter) ; assertEquals(ver.bestHeight, 0) ; assertTrue(ver.subVer.equals(""/nubitsj:0.12.3/"") ) ; ver = new VersionMessage(params, HEX.decode(""71110100000000000000000048e5e9500000000048e5e950000000000000000000000000000000000000ffff7f000001479d48e5e950000000000000000000000000000000000000ffff7f000001479d0000000000000000"") ) ; assertTrue(ver.relayTxesBeforeFilter) ; assertEquals(ver.bestHeight, 0) ; assertTrue(ver.subVer.equals("""") ) ; }"
6,"FeatureCursor extends Cursor<Feature> { public FeatureCursor crs(CoordinateReferenceSystem crs) { return new CrsOverrideCursor(this, crs) ; }  } <|start_header_id|>","@Test public void testCrs() throws Exception { Feature f = new ListFeature(Schema.build(""test"") .field(""geo"", Point.class) .schema() , Geom.point(0, 0) ) ; assertNull(Features.crs(f) ) ; assertNull(Features.schema(""feature"", f) .crs() ) ; f = FeatureCursor.wrap(Cursors.single(f) ) .crs(Proj.EPSG_900913) .first() .get() ; assertEquals(Proj.EPSG_900913, Features.crs(f) ) ; assertEquals(Proj.EPSG_900913, Features.schema(""feature"", f) .crs() ) ; }"
7,GeneratorAdapter extends LocalVariablesSorter { public void push(final boolean value) { push(value ? 1 : 0) ; }  } <|start_header_id|>,"@Test public void testPush_boolean() { assertEquals(""ICONST_0"", new Generator() .push(false) ) ; assertEquals(""ICONST_1"", new Generator() .push(true) ) ; }"
8,"BaseGridWidgetKeyboardHandler implements KeyDownHandler { @Override public void onKeyDown(final KeyDownEvent event) { final GridWidget selectedGridWidget = getSelectedGridWidget() ; if(selectedGridWidget == null) { return; } final KeyboardOperation operation = getOperation(event) ; if(operation == null) { return; } if(!operation.isExecutable(selectedGridWidget) ) { return; } flushDOMElements(selectedGridWidget) ; final boolean redraw = operation.perform(selectedGridWidget, event.isShiftKeyDown() , event.isControlKeyDown() ) ; event.preventDefault() ; event.stopPropagation() ; if(redraw) { gridLayer.draw() ; }  }  } <|start_header_id|>","@Test public void downCursorWithoutShiftKeyMovesDownOneCell() { when(layer.getGridWidgets() ) .thenReturn(gridWidgets) ; when(gridWidget1.isSelected() ) .thenReturn(true) ; when(gridWidget1.selectCell(eq(1) , eq(0) , any(Boolean.class) , any(Boolean.class) ) ) .thenReturn(true) ; when(event.getNativeKeyCode() ) .thenReturn(KeyCodes.KEY_DOWN) ; gridWidget1.getModel() .selectCell(0, 0) ; handler.onKeyDown(event) ; verify(layer, times(1) ) .draw() ; verify(keyboardOperationMoveDown, times(1) ) .perform(eq(gridWidget1) , eq(false) , eq(false) ) ; final List<GridData.SelectedCell> selectedCells = gridWidget1Data.getSelectedCells() ; assertEquals(1, selectedCells.size() ) ; assertEquals(1, selectedCells.get(0) .getRowIndex() ) ; assertEquals(0, selectedCells.get(0) .getColumnIndex() ) ; }"
9,"AuthenticationHelper { public static boolean authenticate(String userName, String userPassword) { LOGGER.entering(userName, StringUtils.isBlank(userPassword) ? userPassword : userPassword.replaceAll(""."", ""*"") ) ; boolean validLogin = false; byte[] currentAuthData; byte[] hashedInputData; if(StringUtils.isBlank(userName) || StringUtils.isBlank(userPassword) ) { return validLogin; } try { File authFile = new File(AUTH_FILE_LOCATION) ; if(!authFile.exists() ) { authFile.createNewFile() ; createAuthFile(authFile, DEFAULT_USERNAME, DEFAULT_PASSWORD) ; } currentAuthData = getBytesFromFile(authFile) ; hashedInputData = hashData(userName, userPassword) ; validLogin = Arrays.equals(currentAuthData, hashedInputData) ; } catch(Exception e) { validLogin = false; } LOGGER.exiting(validLogin) ; return validLogin; }  } <|start_header_id|>","@Test public void testAuthentication() { boolean isValidLogin = AuthenticationHelper.authenticate(""admin"", ""admin"") ; assertTrue(isValidLogin) ; }"
10,"JavaUtilLoggingProvider implements LoggingProvider { @Override public boolean isEnabled(final int depth, final String tag, final Level level) { String callerClassName = RuntimeProvider.getCallerClassName(depth + 1) ; return Logger.getLogger(callerClassName) .isLoggable(translate(level) ) ; }  } <|start_header_id|>","@Test public void enabled() { JavaUtilLoggingProvider provider = new JavaUtilLoggingProvider() ; assertThat(provider.isEnabled(1, null, Level.INFO) ) .isTrue() ; assertThat(provider.isEnabled(1, null, Level.WARN) ) .isTrue() ; assertThat(provider.isEnabled(1, null, Level.ERROR) ) .isTrue() ; }"
11,DefaultManagedArtifact implements ManagedArtifact { public String getHttpContentType() { return HTTP_CONTENT_TYPE; }  } <|start_header_id|>,"@Test public void testContentType() { DefaultManagedArtifact managedArtifact = new DefaultManagedArtifact(artifactFileOnePath) ; Assert.assertEquals(managedArtifact.getHttpContentType() , ""application/zip"", ""Artifact file name does not match"") ; }"
12,"MultipartRequest extends BaseRequest<T> { @Nullable public HashMap<String, List<RequestData>> getMultiPartData() { return multiPartData; }  } <|start_header_id|>","@Test public void builderPostGenerationWithPutMultipartSimple() throws Exception { MultipartRequest.Builder<DummyResponse> builder = new MultipartRequest.Builder<>(Request.Method.POST, url, DummyResponse.class) ; builder.parameters(parameters) ; builder.json(dummyRequestObject) ; builder.headers(headers) ; builder.multiPartData(dummyDataMapNoList) ; MultipartRequest<DummyResponse> baseRequest = builder.build() ; assertEquals(""The url should be the same"", url, baseRequest.getUrl() ) ; assertEquals(""The method should be the same"", Request.Method.POST, baseRequest.getMethod() ) ; assertEquals(""The parameters should be the same"", parameters, baseRequest.getParams() ) ; assertEquals(""The object should be the same"", dummyRequestObject, baseRequest.getJsonObject() ) ; assertEquals(""The multi part should be the same"", dummyDataMap, baseRequest.getMultiPartData() ) ; Map returnedMap = baseRequest.getHeaders() ; for(String key : headers.keySet() ) { assertTrue(""The key should be contained"", returnedMap.containsKey(key) ) ; assertEquals(""The same value should be contained"", headers.get(key) , returnedMap.get(key) ) ; }  }"
13,"ExceptionUtils { public static void propagateVoid(final CheckedRunnable runnable) { propagateVoid(runnable, RuntimeException::new) ; }  } <|start_header_id|>","@Test public void propagateVoidDoesNotThrowExceptionOnSuccess() { ExceptionUtils.propagateVoid(() -> { }) ; Assertions.assertTrue(true, ""No Problems"") ; }"
14,InsnList implements Iterable<AbstractInsnNode> { public int indexOf(final AbstractInsnNode insnNode) { if(cache == null) { cache = toArray() ; } return insnNode.index; }  } <|start_header_id|>,"@Test public void testIndexOf_noSuchElement() { InsnList insnList = newInsnList() ; Executable indexOf =() -> insnList.indexOf(new InsnNode(0) ) ; assertThrows(NoSuchElementException.class, indexOf) ; }"
15,"FileUtils { public static String readFile(String path) throws IOException { byte[] encoded = Files.readAllBytes(Paths.get(path) ) ; return new String(encoded, StandardCharsets.UTF_8) ; }  } <|start_header_id|>","@Test public void readTest() throws IOException { String data = FileUtils.readFile(""src/test/resources/fileUtils.txt"") ; String expected = ""a\\nab\\nabc\\n\\n\\n\\n\\n\\n\\n\\n\\\\n\\n\\n\\n\\n\\ndfe\\n\\ntest""; assertEquals(expected, data) ; }"
16,"CorruptionRiskDashboardIndicatorsStatsController extends GenericOCDSController { @ApiOperation(value = ""Counts the indicators flagged, and groups them by indicator type. "" + ""An indicator that has two types it will be counted twice, once in each group."") @RequestMapping(value = ""/api/totalFlaggedIndicatorsByIndicatorType"", method = { RequestMethod.POST, RequestMethod.GET } , produces = ""application/json"") public List<DBObject> totalFlaggedIndicatorsByIndicatorType(@ModelAttribute @Valid final YearFilterPagingRequest filter) { return totalIndicatorsByIndicatorType(FLAGGED_STATS, filter) ; }  } <|start_header_id|>","@Test public void totalFlagsByIndicatorTypeTest() throws Exception { final List<DBObject> result = corruptionRiskDashboardIndicatorsStatsController .totalFlaggedIndicatorsByIndicatorType(new YearFilterPagingRequest() ) ; Assert.assertEquals(1, result.size() ) ; Assert.assertEquals(FlagType.RIGGING.toString() , result.get(0) .get(CorruptionRiskDashboardIndicatorsStatsController.Keys.TYPE) ) ; Assert.assertEquals(2, result.get(0) .get(CorruptionRiskDashboardIndicatorsStatsController.Keys.INDICATOR_COUNT) ) ; }"
17,"BundleContextProvider implements ContextProvider { @Override public Map<String, String> getMapping() { Map<String, String> mapping = new HashMap<String, String>() ; for(int i = 0; i < providers.length; ++i) { mapping.putAll(providers[i].getMapping() ) ; } return mapping; }  } <|start_header_id|>","@Test public void getConflictiveMapping() { when(first.getMapping() ) .thenReturn(doubletonMap(""pi"", ""3.14"", ""G"", ""0.91"") ) ; when(second.getMapping() ) .thenReturn(doubletonMap(""pi"", ""3.14"", ""G"", ""0.92"") ) ; assertThat(bundle.getMapping() ) .containsEntry(""pi"", ""3.14"") .has(anyOf(""G"", ""0.91"", ""0.92"") ) .hasSize(2) ; }"
18,MovieMediaContainer extends AbstractMediaContainer { public List<VideoContentInfo> createVideos() { videoList = new LinkedList<VideoContentInfo>() ; createVideoContent(mc) ; return videoList; }  } <|start_header_id|>,@Test public void createMoviesReturnsAnEmptyListWhenNoItems() { movieMediaContainer = new MovieMediaContainer(mockMediaContainer) ; doReturn(new ArrayList<Video>() ) .when(mockMediaContainer) .getVideos() ; List<VideoContentInfo> result = movieMediaContainer.createVideos() ; assertThat(result) .isEmpty() ; }
19,"EmailListValidator implements\n ConstraintValidator<EmailList, String>, Serializable { @Override public boolean isValid(String s, ConstraintValidatorContext context) { if(s == null || s.isEmpty() ) { return true; } for(String email : s.trim() .split(""\\\\s*,\\\\s*"") ) { if(!zanataEmailValidator.isValid(email, context) ) { return false; } Set<?> violations = validator.validate(new EmailHolder(email) ) ; if(!violations.isEmpty() ) { return false; }  } return true; }  } <|start_header_id|>","@Test public void emptyIsValid() throws Exception { assertThat(validator.isValid("""", context) ) .isTrue() ; }"
20,TreeListItemView implements TreeListItem.View { @Override public void init(final TreeListItem presenter) { this.presenter = presenter; }  } <|start_header_id|>,"@Test public void testInit() { final TreeListItem presenter = mock(TreeListItem.class) ; itemView.init(presenter) ; final TreeListItem actual = itemView.getPresenter() ; assertEquals(actual, presenter) ; }"
21,"BackgroundBitmapDisplayer implements Runnable { @Override public void run() { if(bitmap == null) { backgroundView.setBackgroundResource(defaultImageId) ; return; } SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(backgroundView.getContext() ) ; boolean shouldFadeIn = preferences.getBoolean(""animation_background_fadein"", false) ; BitmapDrawable bitmapdrawable = new BitmapDrawable(backgroundView.getContext() .getResources() , bitmap) ; if(!shouldFadeIn) { backgroundView.setBackground(bitmapdrawable) ; return; } crossfadeImages(bitmapdrawable) ; }  } <|start_header_id|>","@Test public void backgroundViewHasTransitionDrawableSet() throws Exception { SharedPreferences prefs = PreferenceManager .getDefaultSharedPreferences(ApplicationProvider.getApplicationContext() ) ; Editor editor = prefs.edit() ; editor.putBoolean(""animation_background_fadein"", true) ; editor.commit() ; backgroundBitmapDisplayer = new BackgroundBitmapDisplayer(mockBitmap, R.drawable.movies, backgroundView) ; backgroundBitmapDisplayer.run() ; assertThat(backgroundView.getBackground() ) .isInstanceOf(TransitionDrawable.class) ; }"
22,"LogicalPlanner extends BaseAlgebraVisitor<LogicalPlanner.PlanContext, LogicalNode> { public LogicalPlan createPlan(Session session, Expr expr) throws PlanningException { return createPlan(session, expr, false) ; }  } <|start_header_id|>","@Test public final void testInsertInto0() throws PlanningException { Expr expr = sqlAnalyzer.parse(insertStatements[0]) ; LogicalPlan plan = planner.createPlan(session, expr) ; assertEquals(1, plan.getQueryBlocks() .size() ) ; InsertNode insertNode = getInsertNode(plan) ; assertFalse(insertNode.isOverwrite() ) ; assertTrue(insertNode.hasTargetTable() ) ; assertEquals(CatalogUtil.buildFQName(DEFAULT_DATABASE_NAME, ""score"") , insertNode.getTableName() ) ; }"
23,SpaceContributorsListServiceImpl implements ContributorsListService { @Override public void getContributors(Consumer<List<Contributor>> contributorsConsumer) { organizationalUnitService.call((OrganizationalUnit organizationalUnit) -> { contributorsConsumer.accept(new ArrayList<>(organizationalUnit.getContributors() ) ) ; }) .getOrganizationalUnit(libraryPlaces.getActiveSpace() .getName() ) ; }  } <|start_header_id|>,"@Test public void getContributorsTest() { final List<Contributor> contributors = new ArrayList<>() ; contributors.add(new Contributor(""owner"", ContributorType.OWNER) ) ; contributors.add(new Contributor(""contributor"", ContributorType.CONTRIBUTOR) ) ; contributors.add(new Contributor(""admin"", ContributorType.ADMIN) ) ; final OrganizationalUnit organizationalUnit = mock(OrganizationalUnit.class) ; doReturn(contributors) .when(organizationalUnit) .getContributors() ; doReturn(organizationalUnit) .when(organizationalUnitService) .getOrganizationalUnit(anyString() ) ; service.getContributors(repositoryContributors -> { assertEquals(3, repositoryContributors.size() ) ; }) ; }"
24,Ed25519Curve implements Curve { @Override public BigInteger getHalfGroupOrder() { return Ed25519Group.GROUP_ORDER.shiftRight(1) ; }  } <|start_header_id|>,"@Test public void getNameReturnsCorrectHalfGroupOrder() { final BigInteger halfGroupOrder = GROUP_ORDER.shiftRight(1) ; MatcherAssert.assertThat(CryptoEngines.ed25519Engine() .getCurve() .getHalfGroupOrder() , IsEqual.equalTo(halfGroupOrder) ) ; }"
25,"ProjectDAO extends AbstractDAOImpl<HProject, Long> { public List<HProjectIteration> getReadOnlyIterations(String slug) { Query q = getSession() .createQuery(""from HProjectIteration t where t.project.slug = :projectSlug and t.status = :status"") ; q.setParameter(""projectSlug"", slug) .setParameter(""status"", EntityStatus.READONLY) ; q.setCacheable(true) .setComment(""ProjectDAO.getReadOnlyIterations"") ; @SuppressWarnings(""unchecked"") List<HProjectIteration> list = q.list() ; return list; }  } <|start_header_id|>","@Test public void readOnlyIterationsInCurrentProject() { assertThat(dao.getReadOnlyIterations(""current-project"") .size() ) .isEqualTo(READONLY_ITERS_IN_CURRENT_PROJ) ; }"
26,"PeerPermissionsAdapter extends PeerPermissions { @Override public boolean isPermitted(final Peer localNode, final Peer remotePeer, final Action action) { switch(action) { case DISCOVERY_ALLOW_IN_PEER_TABLE: return outboundIsPermitted(localNode, remotePeer) ; case DISCOVERY_ALLOW_OUTBOUND_NEIGHBORS_REQUEST: return allowOutboundNeighborsRequests(localNode, remotePeer) ; case DISCOVERY_ALLOW_OUTBOUND_BONDING: return allowOutboundBonding(localNode, remotePeer) ; case DISCOVERY_ACCEPT_INBOUND_BONDING: case DISCOVERY_SERVE_INBOUND_NEIGHBORS_REQUEST: case RLPX_ALLOW_NEW_INBOUND_CONNECTION: return inboundIsPermitted(localNode, remotePeer) ; case RLPX_ALLOW_NEW_OUTBOUND_CONNECTION: return outboundIsPermitted(localNode, remotePeer) ; case RLPX_ALLOW_ONGOING_LOCALLY_INITIATED_CONNECTION: return outboundIsPermitted(localNode, remotePeer) ; case RLPX_ALLOW_ONGOING_REMOTELY_INITIATED_CONNECTION: return inboundIsPermitted(localNode, remotePeer) ; default: LOG.error(""Permissions denied for unknown action { } "", action.name() , new IllegalStateException(""Unhandled permissions action "" + action.name() ) ) ; return false; }  }  } <|start_header_id|>","@Test public void allowOutboundBonding_noSyncPermissioning() { mockSyncStatusNodePermissioning(false, false) ; final Action action = Action.DISCOVERY_ALLOW_OUTBOUND_BONDING; mockControllerPermissions(true, false) ; assertThat(adapter.isPermitted(localNode, remoteNode, action) ) .isTrue() ; mockControllerPermissions(false, true) ; assertThat(adapter.isPermitted(localNode, remoteNode, action) ) .isFalse() ; mockControllerPermissions(true, true) ; assertThat(adapter.isPermitted(localNode, remoteNode, action) ) .isTrue() ; mockControllerPermissions(false, false) ; assertThat(adapter.isPermitted(localNode, remoteNode, action) ) .isFalse() ; }"
27,"GenericFacesConverter extends WebApplicationObjectSupport implements ConditionalGenericConverter { public boolean matches(TypeDescriptor sourceType, TypeDescriptor targetType) { if(SpringFacesContext.getCurrentInstance() == null) { return false; } if(targetType.getAnnotation(FacesConverterId.class) != null) { return true; } FacesContext facesContext = SpringFacesContext.getCurrentInstance() .getFacesContext() ; Application application = facesContext.getApplication() ; return((application != null) &&(application.createConverter(targetType.getType() ) != null) ) ; }  } <|start_header_id|>","@Test public void shouldNotMatchIfNoConverterExists() throws Exception { TypeDescriptor targetType = TypeDescriptor.valueOf(ClassWithoutConverter.class) ; assertThat(this.converter.matches(this.sourceType, targetType) , is(false) ) ; }"
28,"MythReflect { public static Map<String, Object> getFieldsValue(Object object) throws IllegalAccessException { Map<String, Object> map = new HashMap<>() ; target = object.getClass() ; for(Field field : target.getDeclaredFields() ) { field.setAccessible(true) ; Object value = field.get(object) ; String name = field.getName() ; map.put(name, value) ; } return map; }  } <|start_header_id|>","@Test public void testGetFieldsValue() throws Exception { Target target = new Target() ; target.setName(""myth"") ; Map<String, Object> result = MythReflect.getFieldsValue(target) ; Assert.assertEquals(new HashMap<String, Object>() {  { put(""name"", ""myth"") ; }  } , result) ; }"
29,"Twimg extends MemoizeMedia { @Override protected String resolveThumbnailUrl() throws IOException { String browseURL = getBrowseUrl() ; String[] split = browseURL.split("":"") ; if(split.length > 2) { return split[0] + "":"" + split[1] + "":thumb""; } else { return browseURL + "":thumb""; }  }  } <|start_header_id|>","@Test public void resolveThumbnailUrl() throws Exception { Twimg twimg = new Twimg(""https: Assert.assertEquals(""https: }"
30,"XMLReader { @SuppressWarnings(""unchecked"") public List<Node> getElementList(String xpathExpr) throws XMLException { XPathExpression xpath = null; try { xpath = createXPath(xpathExpr) ; Object evaluated = xpath.evaluate(document, XPathConstants.NODESET) ; if(evaluated == null) { return Collections.emptyList() ; } NodeList nl =(NodeList) evaluated; List<Node> nodeList = new ArrayList<>() ; for(int i = 0 ; i<nl.getLength() ; i++) { nodeList.add(nl.item(i) ) ; } return nodeList; } catch(XPathExpressionException e) { throw new XMLException(""Could not parse xpath expression"") ; }  }  } <|start_header_id|>","@Test public void testPrologUtf8Read() throws XMLException { Path xmlFile = getExampleXml(""prolog-with-utf8.xml"") ; XMLReader reader = new XMLReader(""basic"", xmlFile) ; List<Node> names = reader.getElementList("" assertElementTexts(names, new String[] { TRYGVIS, INFINITE_ARCHIVA }) ; }"
31,"PropagateErrorsOnUpdateDownloadPolicy extends AbstractPolicy implements DownloadErrorPolicy { @Override public boolean applyPolicy(PolicyOption policySetting, Properties request, StorageAsset localFile, Exception exception, Map<String, Exception> previousExceptions) throws PolicyConfigurationException { if(!options.contains(policySetting) ) { throw new PolicyConfigurationException(""Unknown error policy setting ["" + policySetting + ""], valid settings are ["" + StringUtils.join(options.iterator() , "","") + ""]"") ; } if(ALWAYS.equals(policySetting) ) { return true; } if(NOT_PRESENT.equals(policySetting) ) { return !localFile.exists() ; } throw new PolicyConfigurationException(""Unable to process checksum policy of ["" + policySetting + ""], please file a bug report."") ; }  } <|start_header_id|>","@Test public void testPolicyStop() throws Exception { DownloadErrorPolicy policy = lookupPolicy() ; StorageAsset localFile = getFile() ; Properties request = createRequest() ; Exception ex = new RuntimeException() ; Map<String, Exception> exMap = new HashMap<>() ; assertTrue(policy.applyPolicy(PropagateErrorsOnUpdateDownloadPolicy.ALWAYS, request, localFile, ex, exMap) ) ; }"
32,"Linqy { public static <F, T> Iterable<T> map(final Iterable<F> from, final Mapper<? super F, T> mapper) { return new Iterable<T>() { @Override public Iterator<T> iterator() { return new MappingIterator<F, T>(from.iterator() , mapper) ; }  } ; }  } <|start_header_id|>","@Test public void canRemoveFromMapIterator() { ArrayList al = new ArrayList() ; al.add(""foo"") ; Iterator i = Linqy.map(al, new IdentityMapper() ) .iterator() ; i.next() ; i.remove() ; Assert.assertEquals(0, al.size() ) ; }"
33,"IbftLegacyBlockInterface implements BlockInterface { @Override public Optional<ValidatorVote> extractVoteFromHeader(final BlockHeader header) { final Address candidate = header.getCoinbase() ; if(!candidate.equals(NO_VOTE_SUBJECT) ) { final Address proposer = getProposerOfBlock(header) ; final VoteType votePolarity = voteToValue.inverse() .get(header.getNonce() ) ; final Address recipient = header.getCoinbase() ; return Optional.of(new ValidatorVote(votePolarity, proposer, recipient) ) ; } return Optional.empty() ; }  } <|start_header_id|>","@Test public void headerWithNonceOfMaxLongReportsAddVote() { headerBuilder.nonce(0xFFFFFFFFFFFFFFFFL) .coinbase(AddressHelpers.ofValue(2) ) ; final BlockHeader header = TestHelpers.createIbftSignedBlockHeader(headerBuilder, proposerKeys, validatorList) ; final Optional<ValidatorVote> extractedVote = blockInterface.extractVoteFromHeader(header) ; assertThat(extractedVote) .contains(new ValidatorVote(ADD, proposerAddress, header.getCoinbase() ) ) ; }"
34,"AuthenticationUtils { public static String getJwtTokenFromAuthorizationHeaderValue(final String value) { if(value != null) { final String bearerSchemaName = ""Bearer ""; if(value.startsWith(bearerSchemaName) ) { return value.substring(bearerSchemaName.length() ) ; }  } return null; }  } <|start_header_id|>","@Test public void getJwtTokenFromValidAuthorizationHeaderValueShouldReturnToken() { final String headerValue = ""Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9""; final String token = AuthenticationUtils.getJwtTokenFromAuthorizationHeaderValue(headerValue) ; assertThat(token) .isEqualTo(""eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9"") ; }"
35,BreakpointLocalCheck { public boolean isInfoRightToResume() { final int blockCount = info.getBlockCount() ; if(blockCount <= 0) return false; if(info.isChunked() ) return false; if(info.getFile() == null) return false; final File fileOnTask = task.getFile() ; if(!info.getFile() .equals(fileOnTask) ) return false; if(info.getFile() .length() > info.getTotalLength() ) return false; if(responseInstanceLength > 0 && info.getTotalLength() != responseInstanceLength) { return false; } for(int i = 0; i < blockCount; i++) { BlockInfo blockInfo = info.getBlock(i) ; if(blockInfo.getContentLength() <= 0) return false; } return true; }  } <|start_header_id|>,@Test public void isInfoRightToResume_noFile() { when(info.getFile() ) .thenReturn(null) ; assertThat(check.isInfoRightToResume() ) .isFalse() ; }
36,TopNMetricPublicationController { public MetricPublicationFilter registerAndCreateFilter(Gauge<T> gauge) { gauges.add(gauge) ; return() -> shouldPublishIndividualGaugeMetric(gauge) ; }  } <|start_header_id|>,"@Test public void eligibleGaugesChangeOverTime() { AtomicLong value1 = new AtomicLong(42) ; AtomicLong value2 = new AtomicLong(157) ; Gauge<Long> gauge1 = value1::get; Gauge<Long> gauge2 = value2::get; TopNMetricPublicationController<Long> controller = new TopNMetricPublicationController<>(Comparator.<Long>naturalOrder() , 1, Duration.ofNanos(1) ) ; MetricPublicationFilter filter1 = controller.registerAndCreateFilter(gauge1) ; MetricPublicationFilter filter2 = controller.registerAndCreateFilter(gauge2) ; assertThat(filter1.shouldPublish() ) .isFalse() ; assertThat(filter2.shouldPublish() ) .isTrue() ; value1.set(8888) ; assertThat(filter1.shouldPublish() ) .isTrue() ; assertThat(filter2.shouldPublish() ) .isFalse() ; }"
37,"DefaultUserRepositories implements UserRepositories { @Override public List<String> getObservableRepositoryIds(String principal) throws PrincipalNotFoundException, AccessDeniedException, ArchivaSecurityException { String operation = ArchivaRoleConstants.OPERATION_REPOSITORY_ACCESS; return getAccessibleRepositoryIds(principal, operation) ; }  } <|start_header_id|>","@Test public void testGetObservableRepositoryIds() throws Exception { createUser(USER_ALPACA, ""Al \'Archiva\' Paca"") ; assertEquals(""Expected users"", 3, securitySystem.getUserManager() .getUsers() .size() ) ; setupRepository(""central"") ; setupRepository(""corporate"") ; setupRepository(""internal"") ; setupRepository(""snapshots"") ; setupRepository(""secret"") ; assignRepositoryObserverRole(USER_ALPACA, ""corporate"") ; assignRepositoryObserverRole(USER_ALPACA, ""central"") ; assignRepositoryObserverRole(USER_GUEST, ""corporate"") ; assignGlobalRepositoryObserverRole(USER_ADMIN) ; assertRepoIds(new String[] { ""central"", ""corporate"" } , userRepos.getObservableRepositoryIds(USER_ALPACA) ) ; assertRepoIds(new String[] { ""coporate"" } , userRepos.getObservableRepositoryIds(USER_GUEST) ) ; assertRepoIds(new String[] { ""central"", ""internal"",""corporate"", ""snapshots"", ""secret"" } , userRepos.getObservableRepositoryIds(USER_ADMIN) ) ; }"
38,DefaultPasswordPolicy implements PasswordPolicy { public boolean isValidPassword(char[] password) { return pattern.matcher(new String(password) ) .matches() ; }  } <|start_header_id|>,"@Test public void testComplexRegex() { String expression = ""^(?=.*[a-z]) (?=.*[A-Z]) (?=.*\\\\d) "" + ""(?=.*["" + ""\\\\x21-\\\\x2f"" + ""\\\\x3A-\\\\x40"" + ""\\\\x5b-\\\\x60"" + ""\\\\x7b-\\\\x7e"" + ""]) "" + ""[\\\\x21-\\\\x7e]"" + "" { 8, } $""; PasswordPolicy policy = new DefaultPasswordPolicy(expression, ""dummy"") ; Assert.assertFalse(policy.isValidPassword(""testtest"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""TESTTEST"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""12345678"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""!!!!!!!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""testTEST"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""test1234"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""test!!!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""TEST1234"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""TEST!!!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""1234!!!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""testTEST12"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""testTEST!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""test1234!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""TEST1234!!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""Test!12"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""Test12!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""12Test!"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""12!Test"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""!Test12"".toCharArray() ) ) ; Assert.assertFalse(policy.isValidPassword(""!12Test"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""teST12!!"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""teST!!12"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""TEst!!12"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""TEst12!!"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""12!!teST"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""12!!TEst"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""!!12teST"".toCharArray() ) ) ; Assert.assertTrue(policy.isValidPassword(""!!12TEst"".toCharArray() ) ) ; }"
39,AsyncPackageDataModelOracleImpl implements AsyncPackageDataModelOracle { public String getFQCNByFactName(final String factName) { if(factNameToFQCNHandleRegistry.contains(factName) ) { return factNameToFQCNHandleRegistry.get(factName) ; } else { return factName; }  }  } <|start_header_id|>,"@Test public void testGetFQCNByFactNameInRegistry() throws Exception { assertEquals(""org.test.Person"", oracle.getFQCNByFactName(""Person"") ) ; }"
40,"LogServiceProtoUtil { public static GetLogLengthReplyProto toGetLogLengthReplyProto(long length, Throwable t) { GetLogLengthReplyProto.Builder builder = GetLogLengthReplyProto.newBuilder() ; if(t != null) { builder.setException(toLogException(t) ) ; } else { builder.setLength(length) ; } return builder.build() ; }  } <|start_header_id|>","@Test public void testGetLengthReply() { long len = 100; GetLogLengthReplyProto proto = LogServiceProtoUtil.toGetLogLengthReplyProto(len, null) ; assertEquals(len, proto.getLength() ) ; }"
41,"ElementSelectors { public static ElementSelector byNameAndAttributesControlNS(final String... attribs) { if(attribs == null) { throw new IllegalArgumentException(ATTRIBUTES_MUST_NOT_BE_NULL) ; } final Collection<String> qs = Arrays.asList(attribs) ; if(any(qs, new IsNullPredicate() ) ) { throw new IllegalArgumentException(ATTRIBUTES_MUST_NOT_CONTAIN_NULL_VALUES) ; } final HashSet<String> as = new HashSet<String>(qs) ; return new ElementSelector() { @Override public boolean canBeCompared(Element controlElement, Element testElement) { if(!byName.canBeCompared(controlElement, testElement) ) { return false; } Map<QName, String> cAttrs = Nodes.getAttributes(controlElement) ; Map<String, QName> qNameByLocalName = new HashMap<String, QName>() ; for(QName q : cAttrs.keySet() ) { String local = q.getLocalPart() ; if(as.contains(local) ) { qNameByLocalName.put(local, q) ; }  } for(String a : as) { QName q = qNameByLocalName.get(a) ; if(q == null) { qNameByLocalName.put(a, new QName(a) ) ; }  } return mapsEqualForKeys(cAttrs, Nodes.getAttributes(testElement) , qNameByLocalName.values() ) ; }  } ; }  } <|start_header_id|>","@Test public void byNameAndAttributesControlNS() { Element control = doc.createElement(FOO) ; control.setAttributeNS(SOME_URI, BAR, BAR) ; Element equal = doc.createElement(FOO) ; equal.setAttributeNS(SOME_URI, BAR, BAR) ; Element noAttributes = doc.createElement(FOO) ; Element differentValue = doc.createElement(FOO) ; differentValue.setAttributeNS(SOME_URI, BAR, FOO) ; Element differentName = doc.createElement(FOO) ; differentName.setAttributeNS(SOME_URI, FOO, FOO) ; Element differentNS = doc.createElement(FOO) ; differentNS.setAttributeNS(SOME_URI + ""2"", BAR, BAR) ; Element noNS = doc.createElement(FOO) ; noNS.setAttribute(BAR, BAR) ; assertTrue(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, equal) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, noAttributes) ) ; assertTrue(ElementSelectors.byNameAndAttributesControlNS(FOO) .canBeCompared(control, noAttributes) ) ; assertTrue(ElementSelectors.byNameAndAttributesControlNS(new String[] { }) .canBeCompared(control, noAttributes) ) ; assertTrue(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(noAttributes, control) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(noAttributes, noNS) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, differentValue) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, differentName) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, differentNS) ) ; assertFalse(ElementSelectors.byNameAndAttributesControlNS(BAR) .canBeCompared(control, noNS) ) ; }"
42,AllMUSes { public List<IVecInt> computeAllMUSes() { return computeAllMUSes(VecInt.EMPTY) ; }  } <|start_header_id|>,"@Test public void testEclipseTestCase() throws ContradictionException, TimeoutException { this.solver.newVar(3) ; IVecInt clause = new VecInt() ; clause.push(-1) ; this.solver.addClause(clause) ; clause.clear() ; clause.push(-2) .push(3) ; this.solver.addClause(clause) ; clause.clear() ; clause.push(-2) .push(1) ; this.solver.addClause(clause) ; clause.clear() ; clause.push(2) ; this.solver.addClause(clause) ; clause.clear() ; List<IVecInt> muses = allMUSes.computeAllMUSes() ; assertEquals(1, muses.size() ) ; }"
43,"Util { static Protocol determineProtocol(String server) { checkNotNull(server) ; String[] splitServer = server.split("":"") ; Protocol protocol = Protocol.HTTPS; if(splitServer.length > 1) { String port = splitServer[1]; String protocolInTheUrl = splitServer[0].toLowerCase() ; if(splitServer[1].startsWith("" if(Objects.equal(protocolInTheUrl, ""http"") ) return Protocol.HTTP; else if(Objects.equal(protocolInTheUrl, ""https"") ) return Protocol.HTTPS; port = splitServer[2]; } if(!""443"".equals(port) ) { protocol = Protocol.HTTP; }  } return protocol; }  } <|start_header_id|>","@Test public void shouldDetermineTheProtocolOfAHttpLinkWithANonstandardPort() { String testUrl = ""http: assertThat(determineProtocol(testUrl) ) .isEqualTo(Protocol.HTTP) ; }"
44,"BaseUserEditorWorkflow implements IsWidget { protected void checkDirty(final Command callback) { if(isDirty) { confirmBox.show(UsersManagementWidgetsConstants.INSTANCE.confirmAction() , UsersManagementWidgetsConstants.INSTANCE.userIsDirty() ,() -> { BaseUserEditorWorkflow.this.isDirty = false; callback.execute() ; } ,() -> { }) ; } else { callback.execute() ; }  }  } <|start_header_id|>","@Test public void testCheckDirtyTrue() { final Command command = mock(Command.class) ; tested.isDirty = true; tested.checkDirty(command) ; verify(confirmBox, times(1) ) .show(anyString() , anyString() , any() , any() ) ; verify(command, times(0) ) .execute() ; assertNoViewCalls() ; }"
45,"JsonUtils { public static String formatDateRfc822(Date date, String timeZoneId) { if(date != null) { TimeZone tZone = ""GMT"".equals(timeZoneId) ? GMT_TZ : TimeZone.getTimeZone(timeZoneId) ; SimpleDateFormat dateFormater = new SimpleDateFormat(""EEE, dd MMM yyyy HH:mm:ss zzz"", Locale.US) ; dateFormater.setTimeZone(tZone) ; return dateFormater.format(date) ; } return null; }  } <|start_header_id|>","@Test public void testNullDate() { assertEquals(null, JsonUtils.formatDateRfc822(null) ) ; }"
46,"WiresConnectorView extends WiresConnector implements\n LienzoShapeView<T>,\n IsConnector<T>,\n HasManageableControlPoints<T> { public T setListening(final boolean listening) { listen(listening) ; return cast() ; }  } <|start_header_id|>",@Test public void testListening() { tested.setListening(true) ; assertTrue(tested.getGroup() .isListening() ) ; tested.setListening(false) ; assertFalse(tested.getGroup() .isListening() ) ; }
47,"GuidedTourCustomSelectorPositionProvider { public Rect getPosition(final String querySelector) { final String[] querySelectorParts = getQuerySelectorParts(querySelector) ; final boolean isValidQuerySelector = querySelectorParts.length == 2; if(isValidQuerySelector) { final String type = querySelectorParts[0]; final String selector = querySelectorParts[1]; final Optional<PositionProviderFunction> positionProvider = Optional.ofNullable(providers.get(type) ) ; if(positionProvider.isPresent() ) { return positionProvider.get() .call(selector) ; } else { DomGlobal.console.warn(""[Guided Tour - Position Provider] The position provider could not be found: "" + type) ; }  } else { DomGlobal.console.warn(""[Guided Tour - Position Provider] Invalid custom query selector: "" + querySelector) ; } return none() ; }  } <|start_header_id|>","@Test public void testGetPositionWhenSelectorIsNull() { final Rect position = positionProvider.getPosition(null) ; verify(console) .warn(""[Guided Tour - Position Provider] Invalid custom query selector: null"") ; assertEquals(none, position) ; }"
48,"FabricReconciler { public void manageChildren(ReactShadowNode previousRootShadowNode, ReactShadowNode newRootShadowNode) { SystraceMessage.beginSection(Systrace.TRACE_TAG_REACT_JAVA_BRIDGE, ""FabricReconciler.manageChildren"") .flush() ; try { List<ReactShadowNode> prevList = previousRootShadowNode == null ? null : previousRootShadowNode.getChildrenList() ; manageChildren(newRootShadowNode, prevList, newRootShadowNode.getChildrenList() ) ; } finally { Systrace.endSection(Systrace.TRACE_TAG_REACT_JAVA_BRIDGE) ; }  }  } <|start_header_id|>","@Test public void testVirtualNodes() { ReactShadowNode parent = createNode(0) ; ReactShadowNode child1 = createVirtualNode(1) ; ReactShadowNode child2 = createVirtualNode(2) ; ReactShadowNode child3 = createVirtualNode(3) ; addChildren(parent, child1, child2, child3) ; ReactShadowNode parentCloned = createNode(0) ; ReactShadowNode child4 = createVirtualNode(4) ; addChildren(parentCloned, child1, child4, child3) ; mFabricReconciler.manageChildren(parent, parentCloned) ; List<ManageChildrenOperation> expectedOperations = new ArrayList<>() ; assertThat(mMockUIViewOperationQueue.getOperations() ) .isEqualTo(expectedOperations) ; }"
49,"EnodeURL { public static EnodeURL fromString(final String value) { return fromString(value, EnodeDnsConfiguration.dnsDisabled() ) ; }  } <|start_header_id|>","@Test public void fromString_withMisspelledDiscoveryParam() { final String query = ""adiscport=1234""; final String enodeURLString = ""enode: assertThatThrownBy(() -> EnodeURL.fromString(enodeURLString) ) .isInstanceOf(IllegalArgumentException.class) .hasMessageContaining(""Invalid discovery port: \'"" + query + ""\'"") ; }"
50,"ClosenessCentrality implements VertexScoringAlgorithm<V, Double> { @Override public Double getVertexScore(V v) { if(!graph.containsVertex(v) ) { throw new IllegalArgumentException(""Cannot return score of unknown vertex"") ; } if(scores == null) { compute() ; } return scores.get(v) ; }  } <|start_header_id|>","@Test public void testUndirected() { Graph<String, DefaultEdge> g = new AsUndirectedGraph<>(createInstance1() ) ; VertexScoringAlgorithm<String, Double> pr1 = new ClosenessCentrality<>(g, true, true) ; VertexScoringAlgorithm<String, Double> pr2 = new ClosenessCentrality<>(g, false, true) ; assertEquals(4d / 5, pr1.getVertexScore(""1"") , 1e-9) ; assertEquals(4d / 5, pr2.getVertexScore(""1"") , 1e-9) ; assertEquals(4d / 6, pr1.getVertexScore(""2"") , 1e-9) ; assertEquals(4d / 6, pr2.getVertexScore(""2"") , 1e-9) ; assertEquals(4d / 4, pr1.getVertexScore(""3"") , 1e-9) ; assertEquals(4d / 4, pr2.getVertexScore(""3"") , 1e-9) ; assertEquals(4d / 5, pr1.getVertexScore(""4"") , 1e-9) ; assertEquals(4d / 5, pr2.getVertexScore(""4"") , 1e-9) ; assertEquals(4d / 6, pr1.getVertexScore(""5"") , 1e-9) ; assertEquals(4d / 6, pr2.getVertexScore(""5"") , 1e-9) ; }"
51,"DefaultResourceDependencyResolver implements ResourceDependencyResolver { public LinkedHashSet<String> getSuperBatchDependencies() { if(!batchingConfiguration.isSuperBatchingEnabled() ) { log.warn(""Super batching not enabled, but getSuperBatchDependencies() called. Returning empty set."") ; return new LinkedHashSet<String>() ; } String version = webResourceIntegration.getSuperBatchVersion() ; if(superBatchVersion == null || !superBatchVersion.equals(version) ) { LinkedHashSet<String> webResourceNames = new LinkedHashSet<String>() ; if(batchingConfiguration.getSuperBatchModuleCompleteKeys() != null) { for(String moduleKey : batchingConfiguration.getSuperBatchModuleCompleteKeys() ) { resolveDependencies(moduleKey, webResourceNames, Collections.emptySet() , new Stack<String>() ) ; }  } synchronized(this) { superBatchResources = webResourceNames; superBatchVersion = version; }  } return new LinkedHashSet(superBatchResources) ; }  } <|start_header_id|>","@Test public void testGetSuperBatchDependenciesWithCylicDependency() { String superBatchResource1 = ""plugin.key:resource1""; String superBatchResource2 = ""plugin.key:resource2""; superBatchKeys.add(superBatchResource1) ; superBatchKeys.add(superBatchResource2) ; mockWebResourceIntegration.matchAndReturn(""getSuperBatchVersion"", ""1.0"") ; mockPluginAccessor.matchAndReturn(""getEnabledPluginModule"", C.args(C.eq(superBatchResource1) ) , TestUtils.createWebResourceModuleDescriptor(superBatchResource1, testPlugin, Collections.<ResourceDescriptor>emptyList() , Arrays.asList(superBatchResource2) ) ) ; mockPluginAccessor.matchAndReturn(""getEnabledPluginModule"", C.args(C.eq(superBatchResource2) ) , TestUtils.createWebResourceModuleDescriptor(superBatchResource2, testPlugin, Collections.<ResourceDescriptor>emptyList() , Arrays.asList(superBatchResource1) ) ) ; LinkedHashSet<String> resources = dependencyResolver.getSuperBatchDependencies() ; assertNotNull(resources) ; assertOrder(resources, superBatchResource2, superBatchResource1) ; }"
52,"TransUnitNavigationPresenter extends\n WidgetPresenter<TransUnitNavigationDisplay> implements\n TransUnitNavigationDisplay.Listener, UserConfigChangeHandler { @Override public void goToNextState() { targetContentsPresenter.savePendingChangesIfApplicable() ; eventBus.fireEvent(new NavTransUnitEvent(NavigationType.NextState) ) ; }  } <|start_header_id|>",@Test public void onGoToNextState() { presenter.goToNextState() ; verify(targetContentsPresenter) .savePendingChangesIfApplicable() ; verify(eventBus) .fireEvent(eventCaptor.capture() ) ; assertThat(eventCaptor.getValue() .getRowType() ) .isEqualTo(NextState) ; }
53,"XMLScanner implements Scanner { public static Scanner createScanner(String input) { return createScanner(input, false) ; }  } <|start_header_id|>","@Test public void testNestedElement() { scanner = XMLScanner.createScanner(""<hello><a></a></hello>"") ; assertOffsetAndToken(0, TokenType.StartTagOpen) ; assertOffsetAndToken(1, TokenType.StartTag, ""hello"") ; assertOffsetAndToken(6, TokenType.StartTagClose) ; assertOffsetAndToken(7, TokenType.StartTagOpen) ; assertOffsetAndToken(8, TokenType.StartTag, ""a"") ; assertOffsetAndToken(9, TokenType.StartTagClose) ; assertOffsetAndToken(10, TokenType.EndTagOpen) ; assertOffsetAndToken(12, TokenType.EndTag, ""a"") ; assertOffsetAndToken(13, TokenType.EndTagClose) ; assertOffsetAndToken(14, TokenType.EndTagOpen) ; assertOffsetAndToken(16, TokenType.EndTag, ""hello"") ; assertOffsetAndToken(21, TokenType.EndTagClose) ; }"
54,"RestrictionMosaicRepositoryOkHttpImpl extends AbstractRepositoryOkHttpImpl implements RestrictionMosaicRepository { @Override public Observable<Page<MosaicRestriction<?>>> search(MosaicRestrictionSearchCriteria criteria) { String mosaicId = criteria.getMosaicId() == null ? null : criteria.getMosaicId() .getIdAsHex() ; MosaicRestrictionEntryTypeEnum entryType = criteria.getEntryType() == null ? null : MosaicRestrictionEntryTypeEnum.fromValue(criteria.getEntryType() .getValue() ) ; String targetAddress = toDto(criteria.getTargetAddress() ) ; Integer pageSize = criteria.getPageSize() ; Integer pageNumber = criteria.getPageNumber() ; String offset = criteria.getOffset() ; Order order = toDto(criteria.getOrder() ) ; Callable<MosaicRestrictionsPage> callback =() -> getClient() .searchMosaicRestriction(mosaicId, entryType, targetAddress, pageSize, pageNumber, offset, order) ; return call(callback, page -> toPage(page.getPagination() , page.getData() .stream() .map(this::toMosaicRestriction) .collect(Collectors.toList() ) ) ) ; }  } <|start_header_id|>","@Test public void shouldMosaicGlobalRestriction() throws Exception { MosaicId mosaicId = MapperUtils.toMosaicId(""123"") ; MosaicGlobalRestrictionDTO dto = new MosaicGlobalRestrictionDTO() ; MosaicGlobalRestrictionEntryWrapperDTO wrapperDTO = new MosaicGlobalRestrictionEntryWrapperDTO() ; dto.setMosaicRestrictionEntry(wrapperDTO) ; MosaicGlobalRestrictionEntryDTO entryDTO = new MosaicGlobalRestrictionEntryDTO() ; entryDTO.setKey(ConvertUtils.toString(BigInteger.valueOf(1111) ) ) ; MosaicGlobalRestrictionEntryRestrictionDTO entryRestrictionDto = new MosaicGlobalRestrictionEntryRestrictionDTO() ; entryRestrictionDto.setRestrictionType(MosaicRestrictionTypeEnum.NUMBER_5) ; entryRestrictionDto.setReferenceMosaicId(""456"") ; entryRestrictionDto.setRestrictionValue(BigInteger.valueOf(3333) ) ; entryDTO.setRestriction(entryRestrictionDto) ; List<MosaicGlobalRestrictionEntryDTO> restrictions = new ArrayList<>() ; restrictions.add(entryDTO) ; wrapperDTO.setCompositeHash(""compositeHash"") ; wrapperDTO.setMosaicId(mosaicId.getIdAsHex() ) ; wrapperDTO.setRestrictions(restrictions) ; wrapperDTO.setEntryType(MosaicRestrictionEntryTypeEnum.NUMBER_1) ; mockRemoteCall(toPage(dto) ) ; MosaicGlobalRestriction mosaicGlobalRestriction =(MosaicGlobalRestriction) repository .search(new MosaicRestrictionSearchCriteria() ) .toFuture() .get() .getData() .get(0) ; Assertions.assertEquals(wrapperDTO.getCompositeHash() , mosaicGlobalRestriction.getCompositeHash() ) ; Assertions.assertEquals(MosaicRestrictionEntryType.GLOBAL, mosaicGlobalRestriction.getEntryType() ) ; Assertions.assertEquals(mosaicId, mosaicGlobalRestriction.getMosaicId() ) ; Assertions.assertEquals(1, mosaicGlobalRestriction.getRestrictions() .size() ) ; Assertions.assertEquals(BigInteger.valueOf(3333) , mosaicGlobalRestriction .getRestrictions() .get(BigInteger.valueOf(1111) ) .getRestrictionValue() ) ; Assertions.assertEquals(""0000000000000456"", mosaicGlobalRestriction .getRestrictions() .get(BigInteger.valueOf(1111) ) .getReferenceMosaicId() .getIdAsHex() ) ; Assertions.assertEquals(MosaicRestrictionType.GT, mosaicGlobalRestriction .getRestrictions() .get(BigInteger.valueOf((1111) ) ) .getRestrictionType() ) ; }"
55,"AbstractMetadataRepository implements MetadataRepository { @Override public List<ArtifactMetadata> getArtifactsByProjectVersionFacet(RepositorySession session, String key, String value, String repositoryId) throws MetadataRepositoryException { throw new UnsupportedOperationException() ; }  } <|start_header_id|>","@Test public void testGetArtifactsByProjectVersionMetadataAllRepositories() throws Exception { try(RepositorySession session = getSessionFactory() .createSession() ) { createArtifactWithGenericMetadataFacet(session) ; tryAssert(() -> { Collection<ArtifactMetadata> artifactsByMetadata = getRepository() .getArtifactsByProjectVersionFacet(session, TEST_METADATA_KEY, TEST_METADATA_VALUE, null) ; assertThat(artifactsByMetadata) .hasSize(1) ; }) ; }  }"
56,DefaultComponentInfo implements ComponentInfo { public boolean isValid() { for(UIComponent component : this.components) { if(!isValid(component) ) { return false; }  } return true; }  } <|start_header_id|>,"@Test public void shouldNotBeValidIfAnyAreNotValid() throws Exception { List<UIComponent> components = createComponents(3) ; for(int i = 0; i < components.size() ; i++) { UIComponent component = components.get(i) ; given(((EditableValueHolder) component) .isValid() ) .willReturn(i == components.size() - 1) ; } components.add(2, mock(UIComponent.class) ) ; given(this.context.getMessages(anyString() ) ) .willReturn(EMPTY_MESSAGES) ; ComponentInfo info = new DefaultComponentInfo(this.context, components) ; assertThat(info.isValid() , is(false) ) ; }"
57,"LocationInfowindowController extends GenericOCDSController { @ApiOperation(value = ""Displays the awards, filtered by location. See the location filter "" + ""for the options to filter by"") @RequestMapping(value = ""/api/awardsByLocation"", method = { RequestMethod.POST, RequestMethod.GET } , produces = ""application/json"") @JsonView(Views.Public.class) public List<DBObject> awardsByLocation(@ModelAttribute @Valid final YearFilterPagingRequest filter) { Aggregation agg = newAggregation(match(where(""awards.0"") .exists(true) .orOperator(where(""tender.items.deliveryLocation._id"") .exists(true) , where(""planning.budget.projectLocation._id"") .exists(true) ) .andOperator(getYearDefaultFilterCriteria(filter, ""awards.date"") ) ) , project(""awards"") .andExclude(Fields.UNDERSCORE_ID) , unwind(""awards"") , skip(filter.getSkip() ) , limit(filter.getPageSize() ) ) ; AggregationResults<DBObject> results = mongoTemplate.aggregate(agg, ""release"", DBObject.class) ; List<DBObject> tagCount = results.getMappedResults() ; return tagCount; }  } <|start_header_id|>","@Test public void awardsByLocation() throws Exception { final List<DBObject> awardsByLocation = locationInfowindowController.awardsByLocation(new YearFilterPagingRequest() ) ; Assert.assertEquals(1, awardsByLocation.size() ) ; final DBObject first = awardsByLocation.get(0) ; }"
58,"WorkbenchMenuCompactNavBarView extends WorkbenchMenuNavBarView { @Override public void addContextGroupMenuItem(final String menuItemId, final String id, final String label, final MenuPosition position) { final ListDropDown listDropDown = GWT.create(ListDropDown.class) ; listDropDown.addStyleName(UF_PERSPECTIVE_CONTEXT_MENU) ; final AnchorButton anchor = GWT.create(AnchorButton.class) ; anchor.setDataToggle(Toggle.DROPDOWN) ; anchor.setText(label) ; final DropDownMenu dropDownMenu = GWT.create(DropDownMenu.class) ; listDropDown.add(anchor) ; listDropDown.add(dropDownMenu) ; menuItemContextMenus.get(menuItemId) .add(listDropDown) ; getMenuItemContextWidgetMap() .put(id, dropDownMenu) ; }  } <|start_header_id|>","@Test public void testAddContextGroupMenuItem() { final String menuItemId = ""menuItemId""; final String menuId = RandomStringUtils.random(10) ; final String label = RandomStringUtils.random(10) ; final MenuPosition position = MenuPosition.RIGHT; workbenchMenuCompactNavBarView.addContextGroupMenuItem(menuItemId, menuId, label, position) ; verify(anchorButton) .setText(label) ; verify(listDropDown) .add(anchorButton) ; assertEquals(dropDownMenu, workbenchMenuCompactNavBarView.getMenuItemContextWidgetMap() .get(menuId) ) ; assertTrue(workbenchMenuCompactNavBarView.getMenuItemContextMenus() .containsValue(listDropDown) ) ; }"
59,"PrivGetEeaTransactionCount implements JsonRpcMethod { @Override public JsonRpcResponse response(final JsonRpcRequestContext requestContext) { if(requestContext.getRequest() .getParamLength() != 3) { return new JsonRpcErrorResponse(requestContext.getRequest() .getId() , JsonRpcError.INVALID_PARAMS) ; } final Address address = requestContext.getRequiredParameter(0, Address.class) ; final String privateFrom = requestContext.getRequiredParameter(1, String.class) ; final String[] privateFor = requestContext.getRequiredParameter(2, String[].class) ; try { final long nonce = privacyController.determineEeaNonce(privateFrom, privateFor, address, enclavePublicKeyProvider.getEnclaveKey(requestContext.getUser() ) ) ; return new JsonRpcSuccessResponse(requestContext.getRequest() .getId() , Quantity.create(nonce) ) ; } catch(final MultiTenancyValidationException e) { LOG.error(""Unauthorized privacy multi-tenancy rpc request. { } "", e.getMessage() ) ; return new JsonRpcErrorResponse(requestContext.getRequest() .getId() , GET_PRIVATE_TRANSACTION_NONCE_ERROR) ; } catch(final Exception e) { LOG.error(e.getMessage() , e) ; return new JsonRpcErrorResponse(requestContext.getRequest() .getId() , GET_PRIVATE_TRANSACTION_NONCE_ERROR) ; }  }  } <|start_header_id|>","@Test public void failsWithUnauthorizedErrorIfMultiTenancyValidationFails() { final PrivGetEeaTransactionCount method = new PrivGetEeaTransactionCount(privacyController, enclavePublicKeyProvider) ; when(privacyController.determineEeaNonce(privateFrom, privateFor, address, ENCLAVE_PUBLIC_KEY) ) .thenThrow(new MultiTenancyValidationException(""validation failed"") ) ; final JsonRpcResponse response = method.response(request) ; assertThat(response) .isInstanceOf(JsonRpcErrorResponse.class) ; final JsonRpcErrorResponse errorResponse =(JsonRpcErrorResponse) response; assertThat(errorResponse.getError() ) .isEqualTo(JsonRpcError.GET_PRIVATE_TRANSACTION_NONCE_ERROR) ; }"
60,"CQL { public static Filter parse(String cql) throws ParseException { try { return new CQLBuilder(cql) .parse() ; } catch(Throwable orig) { try { return new ECQLBuilder(cql) .parse() ; } catch(Throwable e) { if(e instanceof ParseException) { throw(ParseException) e; } if(e instanceof TokenMgrError) { throw(ParseException) new ParseException(""Invalid CQL syntax: "" + e.getMessage() ) .initCause(e) ; } throw(ParseException) new ParseException(""CQL Parsing error"") .initCause(e) ; }  }  }  } <|start_header_id|>","@Test public void testLogic() throws ParseException { Filter f = CQL.parse(""foo > 3 AND bar <= 10"") ; assertTrue(f instanceof Logic) ; }"
61,"EmailListValidator implements\n ConstraintValidator<EmailList, String>, Serializable { @Override public boolean isValid(String s, ConstraintValidatorContext context) { if(s == null || s.isEmpty() ) { return true; } for(String email : s.trim() .split(""\\\\s*,\\\\s*"") ) { if(!zanataEmailValidator.isValid(email, context) ) { return false; } Set<?> violations = validator.validate(new EmailHolder(email) ) ; if(!violations.isEmpty() ) { return false; }  } return true; }  } <|start_header_id|>","@Test public void aBCDIsValid() throws Exception { assertThat(validator .isValid(""a@example.com, b@example.org c d@example"", context) ) .isFalse() ; }"
62,"DOMDifferenceEngine extends AbstractDifferenceEngine { ComparisonState compareNodes(final Node control, final XPathContext controlContext, final Node test, final XPathContext testContext) { final Iterable<Node> allControlChildren = new IterableNodeList(control.getChildNodes() ) ; final Iterable<Node> controlChildren = Linqy.filter(allControlChildren, getNodeFilter() ) ; final Iterable<Node> allTestChildren = new IterableNodeList(test.getChildNodes() ) ; final Iterable<Node> testChildren = Linqy.filter(allTestChildren, getNodeFilter() ) ; return compare(new Comparison(ComparisonType.NODE_TYPE, control, getXPath(controlContext) , control.getNodeType() , getParentXPath(controlContext) , test, getXPath(testContext) , test.getNodeType() , getParentXPath(testContext) ) ) .andThen(new Comparison(ComparisonType.NAMESPACE_URI, control, getXPath(controlContext) , control.getNamespaceURI() , getParentXPath(controlContext) , test, getXPath(testContext) , test.getNamespaceURI() , getParentXPath(testContext) ) ) .andThen(new Comparison(ComparisonType.NAMESPACE_PREFIX, control, getXPath(controlContext) , control.getPrefix() , getParentXPath(controlContext) , test, getXPath(testContext) , test.getPrefix() , getParentXPath(testContext) ) ) .andIfTrueThen(control.getNodeType() != Node.ATTRIBUTE_NODE, new Comparison(ComparisonType.CHILD_NODELIST_LENGTH, control, getXPath(controlContext) , Linqy.count(controlChildren) , getParentXPath(controlContext) , test, getXPath(testContext) , Linqy.count(testChildren) , getParentXPath(testContext) ) ) .andThen(new DeferredComparison() { @Override public ComparisonState apply() { return nodeTypeSpecificComparison(control, controlContext, test, testContext) ; }  }) .andIfTrueThen(control.getNodeType() != Node.ATTRIBUTE_NODE, compareChildren(controlContext, allControlChildren, controlChildren, testContext, allTestChildren, testChildren) ) ; }  } <|start_header_id|>","@Test public void compareNodesDifferentNumberOfChildren() { DOMDifferenceEngine d = new DOMDifferenceEngine() ; DiffExpecter ex = new DiffExpecter(ComparisonType.CHILD_NODELIST_LENGTH, 2) ; d.addDifferenceListener(ex) ; d.setComparisonController(ComparisonControllers.StopWhenDifferent) ; Element e1 = doc.createElement(""x"") ; Element e2 = doc.createElement(""x"") ; assertEquals(wrap(ComparisonResult.EQUAL) , d.compareNodes(e1, new XPathContext() , e2, new XPathContext() ) ) ; e1.appendChild(doc.createElement(""x"") ) ; assertEquals(wrapAndStop(ComparisonResult.DIFFERENT) , d.compareNodes(e1, new XPathContext() , e2, new XPathContext() ) ) ; assertEquals(1, ex.invoked) ; e2.appendChild(doc.createElement(""x"") ) ; assertEquals(wrap(ComparisonResult.EQUAL) , d.compareNodes(e1, new XPathContext() , e2, new XPathContext() ) ) ; e2.appendChild(doc.createElement(""x"") ) ; assertEquals(wrapAndStop(ComparisonResult.DIFFERENT) , d.compareNodes(e1, new XPathContext() , e2, new XPathContext() ) ) ; assertEquals(2, ex.invoked) ; }"
63,"DbMapper { public Speaker fromAppSpeaker(@Nullable com.nilhcem.droidconat.data.app.model.Speaker from) { if(from == null) { return null; } return new Speaker(from.getId() , from.getName() , from.getTitle() , from.getBio() , from.getWebsite() , from.getTwitter() , from.getGithub() , from.getPhoto() ) ; }  } <|start_header_id|>","@Test public void should_convert_app_speaker_to_db_speaker() { Speaker speaker = new Speaker(10, ""name"", ""title"", ""bio"", ""website"", ""twitter"", ""github"", ""photo"") ; com.nilhcem.droidconat.data.database.model.Speaker result = dbMapper.fromAppSpeaker(speaker) ; assertThat(result.id) .isEqualTo(10) ; assertThat(result.name) .isEqualTo(""name"") ; assertThat(result.title) .isEqualTo(""title"") ; assertThat(result.bio) .isEqualTo(""bio"") ; assertThat(result.website) .isEqualTo(""website"") ; assertThat(result.twitter) .isEqualTo(""twitter"") ; assertThat(result.github) .isEqualTo(""github"") ; assertThat(result.photo) .isEqualTo(""photo"") ; }"
64,"PermReloadPermissionsFromFile implements JsonRpcMethod { @Override public JsonRpcResponse response(final JsonRpcRequestContext requestContext) { if(!accountWhitelistController.isPresent() && !nodesWhitelistController.isPresent() ) { return new JsonRpcErrorResponse(requestContext.getRequest() .getId() , JsonRpcError.PERMISSIONING_NOT_ENABLED) ; } try { accountWhitelistController.ifPresent(AccountLocalConfigPermissioningController::reload) ; nodesWhitelistController.ifPresent(NodeLocalConfigPermissioningController::reload) ; return new JsonRpcSuccessResponse(requestContext.getRequest() .getId() ) ; } catch(Exception e) { return new JsonRpcErrorResponse(requestContext.getRequest() .getId() , JsonRpcError.ALLOWLIST_RELOAD_ERROR) ; }  }  } <|start_header_id|>","@Test public void whenControllerReloadFailsMethodShouldReturnError() { doThrow(new RuntimeException() ) .when(accountLocalConfigPermissioningController) .reload() ; JsonRpcResponse expectedErrorResponse = new JsonRpcErrorResponse(null, JsonRpcError.ALLOWLIST_RELOAD_ERROR) ; JsonRpcResponse response = method.response(reloadRequest() ) ; assertThat(response) .isEqualToComparingFieldByField(expectedErrorResponse) ; }"
65,"CoreService { public void deleteRole(Role role) throws BusinessException { deleteRole(role.getId() , null, null) ; }  } <|start_header_id|>","@Test(expected = BusinessException.class) public void testDeleteApplicationRoleInvalid() throws BusinessException { try { coreService.deleteRole(7, ""applicationroleDeleteError"", ""applicationroleErrorInvalid"") ; } catch(BusinessException e) { assertEquals(""applicationroleErrorInvalid"", e.getMessageKey() ) ; throw e; }  }"
66,"ECKey implements EncryptableItem, Serializable { public String getPrivateKeyAsHex() { return Utils.HEX.encode(getPrivKeyBytes() ) ; }  } <|start_header_id|>","@Test public void testGetPrivateKeyAsHex() throws Exception { ECKey key = ECKey.fromPrivate(BigInteger.TEN) .decompress() ; assertEquals(""000000000000000000000000000000000000000000000000000000000000000a"", key.getPrivateKeyAsHex() ) ; }"
67,"AbstractTwoLevelMap { public V getItem(final K key1, final K key2) { final Map<K, V> keyOneValues = this.getItems(key1) ; return keyOneValues.computeIfAbsent(key2, k -> createValue() ) ; }  } <|start_header_id|>","@Test public void previouslyUnknownValueCanBeRetrieved() { final AbstractTwoLevelMap<String, MockValue> map = new MockTwoLevelMap() ; final MockValue value = map.getItem(""foo"", ""bar"") ; MatcherAssert.assertThat(value, IsNull.notNullValue() ) ; }"
68,"ResourceTypePermissionValidator { public boolean isValidResourceType(ResourceType resourceType, String resourceId) { if(resourceType.equals(ActivityResourceType.PERSPECTIVE) && appFormerActivities.getAllPerpectivesIds() .contains(resourceId) ) { return true; } else if(resourceType.equals(ActivityResourceType.EDITOR) && appFormerActivities.getAllEditorIds() .contains(resourceId) ) { return true; } else if(resourceType.equals(OrganizationalUnit.RESOURCE_TYPE) ) { return organizationalUnitService.getOrganizationalUnits() .stream() .anyMatch(orgUnit -> resourceId.equals(orgUnit.getName() ) ) ; } else if(resourceType.equals(Repository.RESOURCE_TYPE) ) { return projectService.getAllWorkspaceProjects() .stream() .anyMatch(project -> resourceId.equals(project.getName() ) ) ; } return false; }  } <|start_header_id|>","@Test public void testIsValidPerpectiveType() { doReturn(new Lists.Builder<String>() .add(""ExperimentalFeaturesPerspective"") .build() ) .when(appFormerActivities) .getAllPerpectivesIds() ; assertTrue(permissionValidator.isValidResourceType(ActivityResourceType.PERSPECTIVE, ""ExperimentalFeaturesPerspective"") ) ; assertFalse(permissionValidator.isValidResourceType(ActivityResourceType.PERSPECTIVE, ""TestPerspective"") ) ; }"
69,"CliqueProtocolSchedule { public static ProtocolSchedule create(final GenesisConfigOptions config, final NodeKey nodeKey, final PrivacyParameters privacyParameters, final boolean isRevertReasonEnabled) { final CliqueConfigOptions cliqueConfig = config.getCliqueConfigOptions() ; final Address localNodeAddress = Util.publicKeyToAddress(nodeKey.getPublicKey() ) ; if(cliqueConfig.getEpochLength() <= 0) { throw new IllegalArgumentException(""Epoch length in config must be greater than zero"") ; } final EpochManager epochManager = new EpochManager(cliqueConfig.getEpochLength() ) ; final Optional<EIP1559> eip1559 = ExperimentalEIPs.eip1559Enabled ? Optional.of(new EIP1559(config.getEIP1559BlockNumber() .orElse(0) ) ) : Optional.empty() ; return new ProtocolScheduleBuilder(config, DEFAULT_CHAIN_ID, builder -> applyCliqueSpecificModifications(epochManager, cliqueConfig.getBlockPeriodSeconds() , localNodeAddress, builder, eip1559) , privacyParameters, isRevertReasonEnabled) .createProtocolSchedule() ; }  } <|start_header_id|>","@Test public void protocolSpecsAreCreatedAtBlockDefinedInJson() { final String jsonInput = "" { \\""config\\"": "" + "" { \\""chainId\\"": 4,\\n"" + ""\\""homesteadBlock\\"": 1,\\n"" + ""\\""eip150Block\\"": 2,\\n"" + ""\\""eip155Block\\"": 3,\\n"" + ""\\""eip158Block\\"": 3,\\n"" + ""\\""byzantiumBlock\\"": 1035301 } "" + "" } ""; final GenesisConfigOptions config = GenesisConfigFile.fromConfig(jsonInput) .getConfigOptions() ; final ProtocolSchedule protocolSchedule = CliqueProtocolSchedule.create(config, NODE_KEY, false) ; final ProtocolSpec homesteadSpec = protocolSchedule.getByBlockNumber(1) ; final ProtocolSpec tangerineWhistleSpec = protocolSchedule.getByBlockNumber(2) ; final ProtocolSpec spuriousDragonSpec = protocolSchedule.getByBlockNumber(3) ; final ProtocolSpec byzantiumSpec = protocolSchedule.getByBlockNumber(1035301) ; assertThat(homesteadSpec.equals(tangerineWhistleSpec) ) .isFalse() ; assertThat(tangerineWhistleSpec.equals(spuriousDragonSpec) ) .isFalse() ; assertThat(spuriousDragonSpec.equals(byzantiumSpec) ) .isFalse() ; }"
70,"SyntaxPreferences implements Serializable, Cloneable { public SyntaxStyle getCommentStyle() { return _commentStyle; }  } <|start_header_id|>","@Test public void testGetCommentStyle() throws Exception { classUnderTest.setCommentStyle(testStyle) ; assertEquals(testStyle, classUnderTest.getCommentStyle() ) ; }"
71,SinglePartPanelHelper { PlaceRequest getPlaceFromFirstPart() { if(parts.iterator() .hasNext() ) { PartDefinition part = this.parts.iterator() .next() ; if(part != null) { return part.getPlace() ; }  } return null; }  } <|start_header_id|>,"@Test public void getPlaceFromFirstPartTest() { PlaceRequest place = mock(PlaceRequest.class) ; PartDefinition part = mock(PartDefinition.class) ; when(part.getPlace() ) .thenReturn(place) ; Collection<PartDefinition> parts = Arrays.asList(part) ; singlePartHelper = new SinglePartPanelHelper(parts, placeManager) ; assertTrue(!singlePartHelper.hasNoParts() ) ; assertEquals(place, singlePartHelper.getPlaceFromFirstPart() ) ; }"
72,"DrugOrder extends Order { @Override public boolean hasSameOrderableAs(Order otherOrder) { if(!super.hasSameOrderableAs(otherOrder) ) { return false; } if(!(otherOrder instanceof DrugOrder) ) { return false; } DrugOrder otherDrugOrder =(DrugOrder) otherOrder; if(isNonCodedDrug() || otherDrugOrder.isNonCodedDrug() ) { return OpenmrsUtil.nullSafeEqualsIgnoreCase(this.getDrugNonCoded() , otherDrugOrder.getDrugNonCoded() ) ; } return OpenmrsUtil.nullSafeEquals(this.getDrug() , otherDrugOrder.getDrug() ) ; }  } <|start_header_id|>",@Test public void hasSameOrderableAs_shouldReturnTrueIfTheConceptsMatchAndBothDrugNonCodedIsNull() throws Exception { DrugOrder order = new DrugOrder() ; Concept concept = new Concept() ; order.setConcept(concept) ; DrugOrder otherOrder = new DrugOrder() ; otherOrder.setConcept(concept) ; assertTrue(order.hasSameOrderableAs(otherOrder) ) ; }
73,"TransactionRepositoryOkHttpImpl extends AbstractRepositoryOkHttpImpl implements TransactionRepository { @Override public Observable<Transaction> getTransaction(TransactionGroup group, String transactionHash) { Callable<TransactionInfoDTO> callback =() -> getBasicTransactions(group, transactionHash) ; return exceptionHandling(call(callback) .map(transactionInfoDTO -> mapTransaction(group, transactionInfoDTO) ) ) ; }  } <|start_header_id|>","@Test public void shouldGetTransaction() throws Exception { TransactionInfoDTO transactionInfoDTO = loadTransactionInfoDTO(""aggregateMosaicCreationTransaction.json"", TransactionInfoDTO.class) ; String hash = jsonHelper.getString(transactionInfoDTO, ""meta"", ""hash"") ; mockRemoteCall(transactionInfoDTO) ; Transaction transaction = repository.getTransaction(TransactionGroup.CONFIRMED, hash) .toFuture() .get() ; Assertions.assertNotNull(transaction) ; Assertions.assertEquals(hash, transaction.getTransactionInfo() .get() .getHash() .get() ) ; Assertions.assertEquals(TransactionGroup.CONFIRMED, transaction.getGroup() .get() ) ; }"
74,"BookmarkableUrlHelper { public static String getUrlToken(final String bookmarkableUrl, final String screen) { int st = isPerspectiveInUrl(bookmarkableUrl) ?(bookmarkableUrl.indexOf(PERSPECTIVE_SEP) + 1) : 0; String screensList = bookmarkableUrl.replace(OTHER_SCREEN_SEP, SEPARATOR) .substring(st, bookmarkableUrl.length() ) ; String tokens[] = screensList.split(SEPARATOR) ; Optional<String> token = Arrays.asList(tokens) .stream() .filter(s -> s.contains(screen) ) .findFirst() ; return token.orElse(screen) ; }  } <|start_header_id|>","@Test public void testGetUrlInToken() { final String url1 = ""perspective|#screen1,screen2$#screen3,!screen4""; final String url2 = ""!screen1,#screen2""; assertEquals(""!screen1"", BookmarkableUrlHelper.getUrlToken(url2, ""screen1"") ) ; assertEquals(""#screen2"", BookmarkableUrlHelper.getUrlToken(url2, ""screen2"") ) ; assertEquals(""screen2"", BookmarkableUrlHelper.getUrlToken(url1, ""screen2"") ) ; assertEquals(""#screen1"", BookmarkableUrlHelper.getUrlToken(url1, ""screen1"") ) ; assertEquals(""#screen3"", BookmarkableUrlHelper.getUrlToken(url1, ""screen3"") ) ; assertEquals(""!screen4"", BookmarkableUrlHelper.getUrlToken(url1, ""screen4"") ) ; }"
75,"PaxosStateLogBatchReader implements AutoCloseable { public List<PaxosRound<V>> readBatch(long startSequence, int numEntries) { return AtlasFutures.getUnchecked(Futures.allAsList(LongStream.range(startSequence, startSequence + numEntries) .mapToObj(sequence -> executor.submit(() -> singleRead(sequence) ) ) .collect(Collectors.toList() ) ) ) .stream() .filter(Optional::isPresent) .map(Optional::get) .collect(Collectors.toList() ) ; }  } <|start_header_id|>","@Test public void noResultsReturnsEmptyList() throws IOException { when(mockLog.readRound(anyLong() ) ) .thenReturn(null) ; try(PaxosStateLogBatchReader<PaxosValue> reader = createReader() ) { assertThat(reader.readBatch(START_SEQUENCE, BATCH_SIZE) ) .isEmpty() ; }  }"
76,"EntityWriter { @SuppressWarnings({ ""unchecked"" }) public <T extends Identifiable<?>> T write(T entity) { if(readOnlyEm.contains(entity) ) { readOnlyEm.detach(entity) ; } else if(entity.getId() != null) { Class<T> entityTargetClass =(Class<T>) getTargetClassIfProxied(entity.getClass() ) ; readOnlyEm.detach(readOnlyEm.find(entityTargetClass, entity.getId() ) ) ; } T writtenEntity = writeableEm.merge(entity) ; writeableEm.flush() ; return(T) readOnlyEm.find(getTargetClassIfProxied(writtenEntity.getClass() ) , writtenEntity.getId() ) ; }  } <|start_header_id|>","@Test public void testUpdateDetachedWhichIsInReadOnlyEM() { EntityManager readOnlyEm = newReadOnlyEntityManager() ; EntityManager writeableEm = newEntityManager() ; readOnlyEntityManagerDelegator.setDelegate(readOnlyEm) ; writeableEntityManagerDelegator.setDelegate(writeableEm) ; writeableEm.getTransaction() .begin() ; readOnlyEm.joinTransaction() ; SimpleEntity se = new SimpleEntity(""A"") ; se = entityWriter.write(se) ; writeableEm.getTransaction() .commit() ; readOnlyEm.close() ; writeableEm.close() ; EntityManager readOnlyEm2 = newReadOnlyEntityManager() ; EntityManager writeableEm2 = newEntityManager() ; readOnlyEntityManagerDelegator.setDelegate(readOnlyEm2) ; writeableEntityManagerDelegator.setDelegate(writeableEm2) ; Assert.assertEquals(readOnlyEm2.find(SimpleEntity.class, se.getId() ) , se) ; writeableEm2.getTransaction() .begin() ; se.setData(""B"") ; se = entityWriter.write(se) ; Assert.assertEquals(se.getData() , ""B"") ; writeableEm2.getTransaction() .commit() ; readOnlyEm2.close() ; writeableEm2.close() ; }"
77,"VariantMerger { public Variant merge(Variant current, Variant load) { return merge(current, Collections.singleton(load) ) ; }  } <|start_header_id|>","@Test public void testMergeIndel() { Variant v1 = VariantTestUtils.generateVariantWithFormat(""1:10:ATGTA:-"", VCFConstants.GENOTYPE_KEY + "","" + VCFConstants.GENOTYPE_FILTER_KEY, ""S1"", ""0/1"",""PASS"") ; Variant v2 = VariantTestUtils.generateVariantWithFormat(""1:10:A:T"", VCFConstants.GENOTYPE_KEY + "","" + VCFConstants.GENOTYPE_FILTER_KEY, ""S2"", ""1/1"",""PASS"") ; Variant v3 = VariantTestUtils.generateVariantWithFormat(""1:12:T:A"", VCFConstants.GENOTYPE_KEY + "","" + VCFConstants.GENOTYPE_FILTER_KEY, ""S2"", ""0/1"",""XXX"") ; Variant mergeVar = variantMerger.merge(v1, v2) ; assertEquals(1, mergeVar.getStudies() .get(0) .getSecondaryAlternates() .size() ) ; assertEquals(""2/2"", mergeVar.getStudies() .get(0) .getSampleData(""S2"", VCFConstants.GENOTYPE_KEY) ) ; assertEquals(""PASS"", mergeVar.getStudies() .get(0) .getSampleData(""S2"", VCFConstants.GENOTYPE_FILTER_KEY) ) ; Variant mergeVar2 = variantMerger.merge(mergeVar, v3) ; assertEquals(2, mergeVar.getStudies() .get(0) .getSecondaryAlternates() .size() ) ; assertEquals(new HashSet<>(Arrays.asList(""2/2"",""0/3"") ) , new HashSet<>(Arrays.asList(mergeVar2.getStudies() .get(0) .getSampleData(""S2"", VCFConstants.GENOTYPE_KEY) .split("","") ) ) ) ; assertEquals(""PASS,XXX"", mergeVar.getStudies() .get(0) .getSampleData(""S2"", VCFConstants.GENOTYPE_FILTER_KEY) ) ; }"
78,"DefaultKieCompilerService implements AFCompilerService { @Override public CompletableFuture<KieCompilationResponse> build(Path projectPath, String mavenRepoPath, String settingXML) { return localExecutor.build(projectPath, mavenRepoPath, settingXML) ; }  } <|start_header_id|>","@Test public void buildAndSkipDepsNonExistentProject() throws Exception { AFCompilerService service = new DefaultKieCompilerService() ; CompletableFuture<KieCompilationResponse> futureRes = service.build(tmpRoot, mavenRepoPath, TestUtilMaven.getSettingsFile() , Boolean.FALSE) ; KieCompilationResponse res = futureRes.get() ; assertThat(res.isSuccessful() ) .isFalse() ; assertThat(res.getDependencies() ) .isEmpty() ; }"
79,BlockInfo { public long getRangeRight() { return startOffset + contentLength - 1; }  } <|start_header_id|>,"@Test public void getRangeRight() { BlockInfo info = new BlockInfo(0, 3, 1) ; assertThat(info.getRangeRight() ) .isEqualTo(2) ; info = new BlockInfo(12, 6, 2) ; assertThat(info.getRangeRight() ) .isEqualTo(17) ; }"
80,JvmId { private JvmId() { }  } <|start_header_id|>,"@Test public void testJvmId() throws Exception { final String jvmId = JvmId.get() ; LOG.info(""JVM ID: { } "", jvmId) ; assertEquals(jvmId, JvmId.get() ) ; }"
81,"TimestampRanges { public static PartitionedTimestamps getPartitionedTimestamps(TimestampRange range, int residue, int modulus) { checkModulusAndResidue(residue, modulus) ; long startTimestamp = getLowestTimestampMatchingModulus(range.getLowerBound() , residue, modulus) ; long endTimestamp = range.getUpperBound() % modulus == residue ? range.getUpperBound() : getLowestTimestampMatchingModulus(range.getUpperBound() , residue, modulus) - modulus; if(startTimestamp > endTimestamp) { return ImmutablePartitionedTimestamps.builder() .start(range.getLowerBound() ) .interval(modulus) .count(0) .build() ; } int count =(int) ((endTimestamp - startTimestamp) / modulus) + 1; return ImmutablePartitionedTimestamps.builder() .start(startTimestamp) .interval(modulus) .count(count) .build() ; }  } <|start_header_id|>","@Test public void throwsIfResidueEqualsOrExceedsModulus() { assertThatThrownBy(() -> getPartitionedTimestamps(SEVENTY_THREE_TO_EIGHTY_TWO, 2, 2) ) .isInstanceOf(IllegalArgumentException.class) .hasMessage(""Absolute value of residue 2 equals or exceeds modulus 2 - no solutions"") ; assertThatThrownBy(() -> getPartitionedTimestamps(SEVENTY_THREE_TO_EIGHTY_TWO, -3, 2) ) .isInstanceOf(IllegalArgumentException.class) .hasMessageMatching(""Absolute value of residue -3 equals or exceeds modulus 2 - no solutions"") ; }"
82,"DataReader { public List<String> getKeys() { CodeGeneratorLoggerFactory.getLogger() .debug(String.format(""Reading keys from data file [%s]"", fileName) ) ; List<String> keys = reader.getAllKeys() ; checkForDuplicateKeys(keys) ; return keys; }  } <|start_header_id|>","@Test public void getKeysMobile() throws Exception { DataReader r = new DataReader(YAML_MOBILE) ; List<String> keys = r.getKeys() ; assertTrue(keys.contains(""sampleTextField"") ) ; }"
83,"WarningMessage { FlashMessage getFlashMessage(final DataType dataType, final Command onSuccess, final Command onError) { return new FlashMessage(WARNING, getStrongMessage(dataType) , getRegularMessage() , getErrorElementSelector(dataType) , onSuccess, onError) ; }  } <|start_header_id|>","@Test public void testGetFlashMessage() { final String uuid = ""uuid""; final FlashMessage.Type expectedType = WARNING; final String expectedStrongMessage = ""expectedStrongMessage""; final String expectedRegularMessage = ""expectedRegularMessage""; final String expectedErrorElementSelector = ""[data-row-uuid=\\""uuid\\""] .bootstrap-select""; final Command expectedOnSuccessCallback = mock(Command.class) ; final Command expectedOnErrorCallback = mock(Command.class) ; final DataType dataType = mock(DataType.class) ; final WarningMessage errorMessage = new WarningMessage(translationService) { @Override String getStrongMessage(final DataType dataType) { return expectedStrongMessage; } @Override String getRegularMessage() { return expectedRegularMessage; }  } ; when(dataType.getUUID() ) .thenReturn(uuid) ; final FlashMessage flashMessage = errorMessage.getFlashMessage(dataType, expectedOnSuccessCallback, expectedOnErrorCallback) ; final FlashMessage.Type actualType = flashMessage.getType() ; final String actualStrongMessage = flashMessage.getStrongMessage() ; final String actualRegularMessage = flashMessage.getRegularMessage() ; final String actualErrorElementSelector = flashMessage.getElementSelector() ; final Command actualOnSuccessCallback = flashMessage.getOnSuccess() ; final Command actualOnErrorCallback = flashMessage.getOnError() ; assertEquals(expectedType, actualType) ; assertEquals(expectedStrongMessage, actualStrongMessage) ; assertEquals(expectedRegularMessage, actualRegularMessage) ; assertEquals(expectedErrorElementSelector, actualErrorElementSelector) ; assertEquals(expectedOnSuccessCallback, actualOnSuccessCallback) ; assertEquals(expectedOnErrorCallback, actualOnErrorCallback) ; }"
84,InvalidContentTypeFilter implements ClientResponseFilter { @VisibleForTesting protected static boolean isContentTypeCompatible(final MediaType responseContentType) { if(responseContentType == null || responseContentType.isWildcardType() || responseContentType.isWildcardSubtype() ) { return true; } if(MediaType.TEXT_PLAIN_TYPE.isCompatible(responseContentType) ) { return true; } Matcher matcher = VALID_TYPES_REGEX.matcher(responseContentType.toString() ) ; return matcher.matches() ; }  } <|start_header_id|>,"@Test public void testValidateContentTypes() { assertThat(isContentTypeCompatible(MediaType.TEXT_HTML_TYPE) ) .isFalse() ; assertThat(isContentTypeCompatible(MediaType.APPLICATION_FORM_URLENCODED_TYPE) ) .isTrue() ; assertThat(isContentTypeCompatible(MediaType.MULTIPART_FORM_DATA_TYPE) ) .isFalse() ; assertThat(isContentTypeCompatible(MediaType.APPLICATION_XML_TYPE) ) .isTrue() ; assertThat(isContentTypeCompatible(MediaType.APPLICATION_JSON_TYPE) ) .isTrue() ; assertThat(isContentTypeCompatible(MediaType.APPLICATION_OCTET_STREAM_TYPE) ) .isTrue() ; assertThat(isContentTypeCompatible(MediaType.WILDCARD_TYPE) ) .isTrue() ; MediaType zanataXmlType = new MediaType(""application"", ""vnd.zanata+xml"") ; assertThat(isContentTypeCompatible(zanataXmlType) ) .isTrue() ; assertThat(isContentTypeCompatible(zanataXmlType.withCharset(LATIN_1) ) ) .isTrue() ; MediaType zanataVersionXmlType = new MediaType(""application"", ""vnd.zanata.version+xml"") ; assertThat(isContentTypeCompatible(zanataVersionXmlType) ) .isTrue() ; assertThat(isContentTypeCompatible(zanataVersionXmlType.withCharset(LATIN_1) ) ) .isTrue() ; assertThat(isContentTypeCompatible(MediaType.TEXT_PLAIN_TYPE) ) .isTrue() ; assertThat(isContentTypeCompatible(null) ) .isTrue() ; }"
85,HttpServerResponseImpl implements HttpServerResponse { @Override public boolean ended() { return written; }  } <|start_header_id|>,@Test public void testEnded(TestContext context) { context.assertFalse(response.ended() ) ; response.end() ; context.assertTrue(response.ended() ) ; }
86,LocalizationSetterImpl implements LocalizationSetter { public boolean setLocaleFromLocaleName(String localeName) { boolean supported = isSupportedLocaleName(localeName) ; if(supported) { Locale locale = findClosestSupportedLocale(toLocale(localeName) ) ; persistentLocale.set(locale) ; threadLocale.setLocale(locale) ; } else { Locale requestLocale = request.getLocale() ; Locale supportedLocale = findClosestSupportedLocale(requestLocale) ; threadLocale.setLocale(supportedLocale) ; } return supported; }  } <|start_header_id|>,"@Test public void known_locale() { PersistentLocale pl = mockPersistentLocale() ; ThreadLocale tl = mockThreadLocale() ; Request request = mockRequest() ; tl.setLocale(Locale.FRENCH) ; pl.set(Locale.FRENCH) ; replay() ; LocalizationSetter setter = new LocalizationSetterImpl(request, pl, tl, ""en,fr"") ; assertTrue(setter.setLocaleFromLocaleName(""fr"") ) ; verify() ; }"
87,"BinlogDataId implements DataId { @Override public int compareTo(DataId dataId) { BinlogDataId o =(BinlogDataId) dataId; int cmp = getSyncInitMeta() .compareTo(o.getSyncInitMeta() ) ; if(cmp != 0) { return cmp; } cmp = Long.compare(tableMapPos, o.tableMapPos) ; if(cmp != 0) { return cmp; } cmp = Long.compare(dataPos, o.dataPos) ; if(cmp != 0) { return cmp; } cmp = Integer.compare(ordinal, o.ordinal) ; if(cmp != 0) { return cmp; } return Objects.equals(offset, o.offset) ? 0 : offset == null ? -1 : o.offset == null ? 1 : Objects.compare(offset, o.offset, Comparator.naturalOrder() ) ; }  } <|start_header_id|>","@Test public void compareTo() { BinlogDataId _0 = new BinlogDataId(""mysql-bin.000117"", 4, 40) .setOrdinal(0) .setOffset(null) ; BinlogDataId _00 = new BinlogDataId(""mysql-bin.000117"", 4, 40) .setOrdinal(0) .setOffset(0) ; BinlogDataId _1 = new BinlogDataId(""mysql-bin.000117"", 4, 40) .setOrdinal(1) .setOffset(null) ; BinlogDataId _14 = new BinlogDataId(""mysql-bin.000117"", 14, 40) .setOrdinal(0) .setOffset(null) ; BinlogDataId _118 = new BinlogDataId(""mysql-bin.000118"", 4, 40) .setOrdinal(1) .setOffset(null) ; Assert.assertEquals(-1, _0.compareTo(_00) ) ; Assert.assertEquals(1, _00.compareTo(_0) ) ; Assert.assertEquals(-1, _0.compareTo(_1) ) ; Assert.assertEquals(-1, _00.compareTo(_1) ) ; Assert.assertEquals(-1, _00.compareTo(_14) ) ; Assert.assertEquals(-1, _1.compareTo(_14) ) ; Assert.assertEquals(-1, _0.compareTo(_118) ) ; Assert.assertEquals(-1, _1.compareTo(_118) ) ; Assert.assertEquals(-1, _00.compareTo(_118) ) ; Assert.assertEquals(-1, _14.compareTo(_118) ) ; Assert.assertEquals(0, _0.compareTo(_0) ) ; Assert.assertEquals(0, _00.compareTo(_00) ) ; }"
88,"PrivateWorldStateReader { public Optional<Bytes> getContractCode(final String privacyGroupId, final Hash blockHash, final Address contractAddress) { final Hash latestStateRoot = privateStateRootResolver.resolveLastStateRoot(Bytes32.wrap(Bytes.fromBase64String(privacyGroupId) ) , blockHash) ; return privateWorldStateArchive .get(latestStateRoot) .flatMap(worldState -> Optional.ofNullable(worldState.get(contractAddress) ) ) .flatMap(account -> Optional.ofNullable(account.getCode() ) ) ; }  } <|start_header_id|>","@Test public void absentAccountReturnsEmpty() { final Bytes32 privacyGroupBytes = Bytes32.wrap(Bytes.fromBase64String(PRIVACY_GROUP_ID) ) ; final Address contractAddress = Address.ZERO; when(privateStateRootResolver.resolveLastStateRoot(eq(privacyGroupBytes) , eq(blockHash) ) ) .thenReturn(stateRootHash) ; when(privateWorldStateArchive.get(eq(stateRootHash) ) ) .thenReturn(Optional.of(privateWorldState) ) ; when(privateWorldState.get(eq(contractAddress) ) ) .thenReturn(null) ; final Optional<Bytes> maybeContractCode = privateWorldStateReader.getContractCode(PRIVACY_GROUP_ID, blockHash, contractAddress) ; assertThat(maybeContractCode) .isNotPresent() ; }"
89,"WorldStateDownloader implements WorldStateDownloadStatus { public CompletableFuture<Void> run(final BlockHeader header) { synchronized(this) { final WorldDownloadState oldDownloadState = this.downloadState.get() ; if(oldDownloadState != null && oldDownloadState.isDownloading() ) { final CompletableFuture<Void> failed = new CompletableFuture<>() ; failed.completeExceptionally(new IllegalStateException(""Cannot run an already running "" + this.getClass() .getSimpleName() ) ) ; return failed; } final Hash stateRoot = header.getStateRoot() ; if(worldStateStorage.isWorldStateAvailable(stateRoot) ) { LOG.info(""World state already available for block { }({ }) . State root { } "", header.getNumber() , header.getHash() , stateRoot) ; return CompletableFuture.completedFuture(null) ; } LOG.info(""Begin downloading world state from peers for block { }({ }) . State root { } "", header.getNumber() , header.getHash() , stateRoot) ; final WorldDownloadState newDownloadState = new WorldDownloadState(taskCollection, maxNodeRequestsWithoutProgress, minMillisBeforeStalling, clock) ; this.downloadState.set(newDownloadState) ; if(!newDownloadState.downloadWasResumed() ) { newDownloadState.enqueueRequest(NodeDataRequest.createAccountDataRequest(stateRoot) ) ; } maybeCompleteTask = Optional.of(new CompleteTaskStep(worldStateStorage, metricsSystem, taskCollection::size) ) ; final WorldStateDownloadProcess downloadProcess = WorldStateDownloadProcess.builder() .hashCountPerRequest(hashCountPerRequest) .maxOutstandingRequests(maxOutstandingRequests) .loadLocalDataStep(new LoadLocalDataStep(worldStateStorage, metricsSystem) ) .requestDataStep(new RequestDataStep(ethContext, metricsSystem) ) .persistDataStep(new PersistDataStep(worldStateStorage) ) .completeTaskStep(maybeCompleteTask.get() ) .downloadState(newDownloadState) .pivotBlockHeader(header) .metricsSystem(metricsSystem) .build() ; newDownloadState.setWorldStateDownloadProcess(downloadProcess) ; return newDownloadState.startDownload(downloadProcess, ethContext.getScheduler() ) ; }  }  } <|start_header_id|>","@Test public void doesNotRequestKnownCodeFromNetwork() { final WorldStateArchive remoteWorldStateArchive = createInMemoryWorldStateArchive() ; final MutableWorldState remoteWorldState = remoteWorldStateArchive.getMutable() ; final List<Account> accounts = dataGen.createRandomContractAccountsWithNonEmptyStorage(remoteWorldState, 20) ; final Hash stateRoot = remoteWorldState.rootHash() ; final BlockHeader header = dataGen.block(BlockOptions.create() .setStateRoot(stateRoot) .setBlockNumber(10) ) .getHeader() ; final List<RespondingEthPeer> peers = Stream.generate(() -> EthProtocolManagerTestUtil.createPeer(ethProtocolManager, header.getNumber() ) ) .limit(5) .collect(Collectors.toList() ) ; final CachingTaskCollection<NodeDataRequest> taskCollection = new CachingTaskCollection<>(new InMemoryTaskQueue<>() ) ; final WorldStateStorage localStorage = new WorldStateKeyValueStorage(new InMemoryKeyValueStorage() ) ; final Map<Bytes32, Bytes> knownCode = new HashMap<>() ; accounts.subList(0, 5) .forEach(a -> knownCode.put(a.getCodeHash() , a.getCode() ) ) ; final Updater localStorageUpdater = localStorage.updater() ; knownCode.forEach(localStorageUpdater::putCode) ; localStorageUpdater.commit() ; final WorldStateDownloader downloader = createDownloader(ethProtocolManager.ethContext() , localStorage, taskCollection) ; final CompletableFuture<Void> result = downloader.run(header) ; final List<MessageData> sentMessages = new ArrayList<>() ; final RespondingEthPeer.Responder blockChainResponder = RespondingEthPeer.blockchainResponder(mock(Blockchain.class) , remoteWorldStateArchive) ; final RespondingEthPeer.Responder responder = RespondingEthPeer.wrapResponderWithCollector(blockChainResponder, sentMessages) ; respondUntilDone(peers, responder, result) ; final List<Bytes32> requestedHashes = sentMessages.stream() .filter(m -> m.getCode() == EthPV63.GET_NODE_DATA) .map(GetNodeDataMessage::readFrom) .flatMap(m -> StreamSupport.stream(m.hashes() .spliterator() , true) ) .collect(Collectors.toList() ) ; assertThat(requestedHashes.size() ) .isGreaterThan(0) ; assertThat(Collections.disjoint(requestedHashes, knownCode.keySet() ) ) .isTrue() ; final WorldStateArchive localWorldStateArchive = new DefaultWorldStateArchive(localStorage, createPreimageStorage() ) ; final WorldState localWorldState = localWorldStateArchive.get(stateRoot) .get() ; assertThat(result) .isDone() ; assertAccountsMatch(localWorldState, accounts) ; }"
90,"DefaultDirectoryWriter implements DirectoryWriter { protected Directory getDirectory(final File directory, final String requestUrl, final boolean includeParent) { if(!directory.isDirectory() ) { throw new IllegalArgumentException(""Input directory is not a valid directory. Unable to continue."") ; } if(StringUtils.isBlank(requestUrl) ) { throw new IllegalArgumentException(""No request url entered. Unable to continue."") ; } final Directory dir = new Directory() ; if(includeParent) { final Entry parent = new Entry() ; String url = requestUrl; if(url.charAt(url.length() - 1) == \'/\') { url = url.substring(0, url.length() - 2) ; } url = url.substring(0, url.lastIndexOf(\'/\') ) ; parent.setName(""../"") ; parent.setUrl(url) ; parent.setSize(0L) ; parent.setLastModified(Instant.ofEpochMilli(directory.getParentFile() .getAbsoluteFile() .lastModified() ) ) ; dir.setParent(parent) ; } final File[] files = directory.listFiles() ; dir.setDirectories(Lists.newArrayList() ) ; dir.setFiles(Lists.newArrayList() ) ; final String baseURL = requestUrl.endsWith(""/"") ? requestUrl : requestUrl + ""/""; if(files != null) { for(final File file : files) { final Entry entry = new Entry() ; entry.setLastModified(Instant.ofEpochMilli(file.getAbsoluteFile() .lastModified() ) ) ; if(file.isDirectory() ) { entry.setName(file.getName() + ""/"") ; entry.setUrl(baseURL + file.getName() + ""/"") ; entry.setSize(0L) ; dir.getDirectories() .add(entry) ; } else { entry.setName(file.getName() ) ; entry.setUrl(baseURL + file.getName() ) ; entry.setSize(file.getAbsoluteFile() .length() ) ; dir.getFiles() .add(entry) ; }  }  } dir.getDirectories() .sort(Comparator.comparing(Entry::getName) ) ; dir.getFiles() .sort(Comparator.comparing(Entry::getName) ) ; return dir; }  } <|start_header_id|>","@Test void canGetDirectoryWithParent() { this.setupWithParent() ; final DefaultDirectoryWriter.Directory dir = this.writer.getDirectory(this.directory, REQUEST_URL_WITH_PARENT, true) ; Assertions.assertThat(dir.getParent() ) .isNotNull() ; Assertions.assertThat(dir.getParent() .getName() ) .isEqualTo(PARENT_NAME) ; Assertions.assertThat(dir.getParent() .getUrl() ) .isEqualTo(PARENT_URL) ; Assertions.assertThat(dir.getParent() .getSize() ) .isEqualTo(PARENT_SIZE) ; Assertions.assertThat(dir.getParent() .getLastModified() ) .isEqualTo(PARENT_LAST_MODIFIED) ; Assertions.assertThat(dir.getDirectories() ) .isNotNull() ; Assertions .assertThat(dir.getDirectories() ) .containsExactlyInAnyOrder(this.directoryEntry1, this.directoryEntry2) ; Assertions.assertThat(dir.getFiles() ) .isNotNull() ; Assertions.assertThat(dir.getFiles() ) .containsExactlyInAnyOrder(this.fileEntry1, this.fileEntry2) ; }"
91,"AINT32 { public static List<INT32> read(InputStream is) throws IOException { Validators.notNull(""is"", is) ; long length = UINT32.read(is) .longValue() ; List<INT32> list = new ArrayList<>((int) length) ; for(int i = 0; i < length; i++) { list.add(INT32.read(is) ) ; } return list; }  } <|start_header_id|>","@Test public void read() throws IOException { INT32 given = INT32.MAX_VALUE; List<INT32> expected = new ArrayList<>() ; expected.add(given) ; byte[] givenBytes = ArrayUtils.join(new UINT32(1) .bytes() , given.bytes() ) ; InputStream givenInputStream = new ByteArrayInputStream(givenBytes) ; List<INT32> actual = AINT32.read(givenInputStream) ; assertThat(actual, is(expected) ) ; }"
92,SpringWebContractReader implements ContractReader { @Override public EndpointMethods read(EndpointTarget target) { return new EndpointMethods(doRead(target) ) ; }  } <|start_header_id|>,"@Test public void shouldCreateEndpointMethodMergingEndpointHeadersDeclaredOnTypeWithDeclaredOnMethod() throws Exception { EndpointMethod endpointMethod = springWebContractReader.read(myApiTypeTarget) .find(MyApiType.class.getMethod(""mergeHeaders"") ) .orElseThrow(() -> new IllegalStateException(""Method not found..."") ) ;; assertEquals(""GET"", endpointMethod.httpMethod() ) ; assertEquals(""http: assertEquals(JavaType.of(String.class) , endpointMethod.returnType() ) ; Optional<EndpointHeader> myTypeHeader = endpointMethod.headers() .first(""X-My-Type"") ; assertTrue(myTypeHeader.isPresent() ) ; assertEquals(""MyApiType"", myTypeHeader.get() .value() ) ; Optional<EndpointHeader> contentTypeHeader = endpointMethod.headers() .first(""Content-Type"") ; assertTrue(contentTypeHeader.isPresent() ) ; assertEquals(""application/json"", contentTypeHeader.get() .value() ) ; Optional<EndpointHeader> acceptHeader = endpointMethod.headers() .first(""Accept"") ; assertTrue(acceptHeader.isPresent() ) ; assertEquals(""application/json, application/xml"", acceptHeader.get() .value() ) ; Optional<EndpointHeader> userAgentHeader = endpointMethod.headers() .first(""User-Agent"") ; assertTrue(userAgentHeader.isPresent() ) ; assertEquals(""Spring-Restify-Agent"", userAgentHeader.get() .value() ) ; }"
93,"ZooKeeperUtils { public static boolean atomicRecursiveDelete(final CuratorFramework zkClient, final String path) throws IOException { try { buildAtomicRecursiveDelete(zkClient, zkClient.inTransaction() , path) .commit() ; return true; } catch(NoNodeException nne) { LOG.debug(""NoNodeException while attempting an atomic recursive delete: { } ."", nne.getMessage() ) ; } catch(NotEmptyException nee) { LOG.debug(""NotEmptyException while attempting an atomic recursive delete: { } ."", nee.getMessage() ) ; } catch(Exception e) { wrapAndRethrow(e) ; } return false; }  } <|start_header_id|>","@Test public void testAtomicRecursiveDeleteWithPersistentENode() throws Exception { final String path = ""/foo/bar/baz/faz/fooz""; PersistentEphemeralNode node = new PersistentEphemeralNode(mZKClient, Mode.EPHEMERAL, path, new byte[0]) ; try { node.start() ; node.waitForInitialCreate(5, TimeUnit.SECONDS) ; Assert.assertTrue(ZooKeeperUtils.atomicRecursiveDelete(mZKClient, ""/foo"") ) ; Thread.sleep(1000) ; Assert.assertNotNull(mZKClient.checkExists() .forPath(""/foo"") ) ; } finally { node.close() ; }  }"
94,"Whitebox { public static synchronized <T> T invokeMethod(Object instance, Object... arguments) throws Exception { return WhiteboxImpl.invokeMethod(instance, arguments) ; }  } <|start_header_id|>","@Test public void testInvokePrivateMethod_wrappedType_primitive() throws Exception { assertTrue((Boolean) Whitebox.invokeMethod(new ClassWithPrivateMethods() , ""wrappedMethod"", 8.2) ) ; }"
95,"Strings { public static String getFormattedCustomFileName(String baseName, Calendar calendar, PreferenceHelper ph) { String finalFileName = baseName; finalFileName = finalFileName.replaceAll(""(?i) %ser"", String.valueOf(getBuildSerial() ) ) ; finalFileName = finalFileName.replaceAll(""(?i) %ver"", String.valueOf(BuildConfig.VERSION_NAME) ) ; finalFileName = finalFileName.replaceAll(""(?i) %hour"", String.format(""%02d"", calendar.get(Calendar.HOUR_OF_DAY) ) ) ; finalFileName = finalFileName.replaceAll(""(?i) %min"", String.format(""%02d"", calendar.get(Calendar.MINUTE) ) ) ; finalFileName = finalFileName.replaceAll(""(?i) %year"", String.valueOf(calendar.get(Calendar.YEAR) ) ) ; finalFileName = finalFileName.replaceAll(""(?i) %monthname"", new SimpleDateFormat(""MMM"", Locale.ENGLISH) .format(calendar.getTime() ) .toLowerCase() ) ; finalFileName = finalFileName.replaceAll(""(?i) %month"", String.format(""%02d"", calendar.get(Calendar.MONTH) +1) ) ; finalFileName = finalFileName.replaceAll(""(?i) %dayname"", new SimpleDateFormat(""EE"", Locale.ENGLISH) .format(calendar.getTime() ) .toLowerCase() ) ; finalFileName = finalFileName.replaceAll(""(?i) %day"", String.format(""%02d"", calendar.get(Calendar.DAY_OF_MONTH) ) ) ; finalFileName = finalFileName.replaceAll(""(?i) %profile"", String.valueOf(ph.getCurrentProfileName() ) ) ; return finalFileName; }  } <|start_header_id|>","@Test public void GetFormattedCustomFileName_YEARMONDAY_ReplaceWithYearMonthDay() { PreferenceHelper ph = mock(PreferenceHelper.class) ; Calendar gc = mock(Calendar.class) ; when(gc.get(Calendar.YEAR) ) .thenReturn(2016) ; when(gc.get(Calendar.MONTH) ) .thenReturn(Calendar.FEBRUARY) ; when(gc.get(Calendar.DAY_OF_MONTH) ) .thenReturn(1) ; String actual = Strings.getFormattedCustomFileName(""basename_%YEAR%MONTH%DAY"", gc, ph) ; String expected = ""basename_20160201""; assertThat(""Year 2016 Month February Day 1 should be replaced with 20160301"", actual, is(expected) ) ; when(gc.get(Calendar.MONTH) ) .thenReturn(Calendar.DECEMBER) ; actual = Strings.getFormattedCustomFileName(""basename_%YEAR%MONTH%DAY"", gc, ph) ; expected = ""basename_20161201""; assertThat(""December month should be replaced with 12"", actual, is(expected) ) ; when(gc.get(Calendar.MONTH) ) .thenReturn(0) ; actual = Strings.getFormattedCustomFileName(""basename_%YEAR%MONTH%DAY"", gc, ph) ; expected = ""basename_20160101""; assertThat(""Zero month should be replaced with 1"", actual, is(expected) ) ; }"
96,"TableDesc implements ProtoObject<TableDescProto>, GsonObject, Cloneable { public TableDescProto getProto() { if(builder == null) { builder = TableDescProto.newBuilder() ; } if(this.tableName != null) { builder.setTableName(this.tableName) ; } if(this.schema != null) { builder.setSchema(schema.getProto() ) ; } if(this.meta != null) { builder.setMeta(meta.getProto() ) ; } if(this.uri != null) { builder.setPath(this.uri.toString() ) ; } if(this.stats != null) { builder.setStats(this.stats.getProto() ) ; } if(this.partitionMethodDesc != null) { builder.setPartition(this.partitionMethodDesc.getProto() ) ; } if(this.external != null) { builder.setIsExternal(external) ; } return builder.build() ; }  } <|start_header_id|>","@Test public void testGetProto() throws CloneNotSupportedException, IOException { Path path = new Path(CommonTestingUtil.getTestDir() , ""tajo"") ; TableDesc desc = new TableDesc(""table1"", schema, info, path) ; desc.setStats(stats) ; CatalogProtos.TableDescProto proto = desc.getProto() ; TableDesc fromProto = new TableDesc(proto) ; assertEquals(""equality check the object deserialized from json"", desc, fromProto) ; }"
97,DelegationClassLoader extends ClassLoader { public Class loadClass(String name) throws ClassNotFoundException { return delegateClassLoader.loadClass(name) ; }  } <|start_header_id|>,"@Test public void testLoadSystemClassWithOutDelegateSet() throws ClassNotFoundException { DelegationClassLoader classLoader = new DelegationClassLoader() ; Class c = classLoader.loadClass(""java.lang.String"") ; assertNotNull(c) ; }"
98,"ConceptMapTypeValidator implements Validator { public void validate(Object obj, Errors errors) { if(obj == null || !(obj instanceof ConceptMapType) ) { throw new IllegalArgumentException(""The parameter obj should not be null and must be of type"" + ConceptMapType.class) ; } ConceptMapType conceptMapType =(ConceptMapType) obj; String name = conceptMapType.getName() ; if(!StringUtils.hasText(name) ) { errors.rejectValue(""name"", ""ConceptMapType.error.nameRequired"", ""The name property is required for a concept map type"") ; return; } name = name.trim() ; ConceptMapType duplicate = Context.getConceptService() .getConceptMapTypeByName(name) ; if(duplicate != null && !OpenmrsUtil.nullSafeEquals(duplicate.getUuid() , conceptMapType.getUuid() ) ) { errors.rejectValue(""name"", ""ConceptMapType.duplicate.name"", ""Duplicate concept map type name: "" + name) ; } ValidateUtil.validateFieldLengths(errors, obj.getClass() , ""name"", ""description"", ""retireReason"") ; }  } <|start_header_id|>","@Test @Verifies(value = ""should fail if the name is an empty string"", method = ""validate(Object,Errors) "") public void validate_shouldFailIfTheNameIsAnEmptyString() throws Exception { ConceptMapType mapType = new ConceptMapType() ; mapType.setName("""") ; Errors errors = new BindException(mapType, ""mapType"") ; new ConceptMapTypeValidator() .validate(mapType, errors) ; Assert.assertEquals(true, errors.hasFieldErrors(""name"") ) ; }"
99,"FutureUtils { public static <T> CompletableFuture<T> exceptionallyCompose(final CompletableFuture<T> future, final Function<Throwable, CompletionStage<T>> errorHandler) { final CompletableFuture<T> result = new CompletableFuture<>() ; future.whenComplete((value, error) -> { try { final CompletionStage<T> nextStep = error != null ? errorHandler.apply(error) : completedFuture(value) ; propagateResult(nextStep, result) ; } catch(final Throwable t) { result.completeExceptionally(t) ; }  }) ; return result; }  } <|start_header_id|>","@Test public void shouldComposeExceptionallyWhenErrorOccursAndErrorHandlerThrowsException() { final Function<Throwable, CompletionStage<String>> errorHandler = mockFunction() ; final CompletableFuture<String> input = new CompletableFuture<>() ; final IllegalStateException thrownException = new IllegalStateException(""Oops"") ; when(errorHandler.apply(ERROR) ) .thenThrow(thrownException) ; final CompletableFuture<String> result = exceptionallyCompose(input, errorHandler) ; verifyZeroInteractions(errorHandler) ; assertThat(result) .isNotDone() ; input.completeExceptionally(ERROR) ; verify(errorHandler) .apply(ERROR) ; assertCompletedExceptionally(result, thrownException) ; }"
100,"TimestampToken implements Token { @Override public void render(final LogEntry logEntry, final StringBuilder builder) { builder.append(getTime(logEntry) ) ; }  } <|start_header_id|>","@Test public void renderMillisecondsPattern() { TimestampToken token = new TimestampToken(""milliseconds"") ; assertThat(render(token, LocalDateTime.of(2016, 6, 30, 12, 0, 0, 0) ) ) .isEqualTo(""1467288000000"") ; assertThat(render(token, LocalDateTime.of(2016, 6, 30, 12, 15, 1, 987654321) ) ) .isEqualTo(""1467288901987"") ; }"
